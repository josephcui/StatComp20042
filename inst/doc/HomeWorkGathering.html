<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Homework</title>

<style type="text/css">
a.anchor-section {margin-left: 10px; visibility: hidden; color: inherit;}
a.anchor-section::before {content: '#';}
.hasAnchor:hover a.anchor-section {visibility: visible;}
</style>
<script>// Anchor sections v1.0 written by Atsushi Yasumoto on Oct 3rd, 2020.
document.addEventListener('DOMContentLoaded', function() {
  // Do nothing if AnchorJS is used
  if (typeof window.anchors === 'object' && anchors.hasOwnProperty('hasAnchorJSLink')) {
    return;
  }

  const h = document.querySelectorAll('h1, h2, h3, h4, h5, h6');

  // Do nothing if sections are already anchored
  if (Array.from(h).some(x => x.classList.contains('hasAnchor'))) {
    return null;
  }

  // Use section id when pandoc runs with --section-divs
  const section_id = function(x) {
    return ((x.classList.contains('section') || (x.tagName === 'SECTION'))
            ? x.id : '');
  };

  // Add anchors
  h.forEach(function(x) {
    const id = x.id || section_id(x.parentElement);
    if (id === '') {
      return null;
    }
    let anchor = document.createElement('a');
    anchor.href = '#' + id;
    anchor.classList = ['anchor-section'];
    x.classList.add('hasAnchor');
    x.appendChild(anchor);
  });
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>



<div id="第一次作业" class="section level1">
<h1>第一次作业</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce 3 examples in the book. The 1st example should contain texts and at least one figure. The 2nd example should contains texts and at least one table. The 3rd example should contain at least a couple of LaTeX formulas.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div id="first-example" class="section level3">
<h3>1.First Example</h3>
<p>R中的women数据集记录了美国女性的平均身高和体重，作图并线性拟合，如下： <img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="second-example" class="section level3">
<h3>2.Second Example</h3>
<p>R中的swiss数据集记录了瑞士在1888年的各省份生育率和社会经济指标:</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Fertility</th>
<th align="right">Agriculture</th>
<th align="right">Examination</th>
<th align="right">Education</th>
<th align="right">Catholic</th>
<th align="right">Infant.Mortality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Courtelary</td>
<td align="right">80.2</td>
<td align="right">17.0</td>
<td align="right">15</td>
<td align="right">12</td>
<td align="right">9.96</td>
<td align="right">22.2</td>
</tr>
<tr class="even">
<td align="left">Delemont</td>
<td align="right">83.1</td>
<td align="right">45.1</td>
<td align="right">6</td>
<td align="right">9</td>
<td align="right">84.84</td>
<td align="right">22.2</td>
</tr>
<tr class="odd">
<td align="left">Franches-Mnt</td>
<td align="right">92.5</td>
<td align="right">39.7</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">93.40</td>
<td align="right">20.2</td>
</tr>
<tr class="even">
<td align="left">Moutier</td>
<td align="right">85.8</td>
<td align="right">36.5</td>
<td align="right">12</td>
<td align="right">7</td>
<td align="right">33.77</td>
<td align="right">20.3</td>
</tr>
<tr class="odd">
<td align="left">Neuveville</td>
<td align="right">76.9</td>
<td align="right">43.5</td>
<td align="right">17</td>
<td align="right">15</td>
<td align="right">5.16</td>
<td align="right">20.6</td>
</tr>
<tr class="even">
<td align="left">Porrentruy</td>
<td align="right">76.1</td>
<td align="right">35.3</td>
<td align="right">9</td>
<td align="right">7</td>
<td align="right">90.57</td>
<td align="right">26.6</td>
</tr>
</tbody>
</table>
</div>
<div id="third-example" class="section level3">
<h3>3.Third Example</h3>
<p>(a): <span class="math inline">\(F(x)\)</span>在<span class="math inline">\(x=t\)</span>处的导数为：<span class="math inline">\(F&#39;(t) = \lim_{\Delta t \to 0}\frac{F(t+\Delta t)-F(t)}{\Delta t}\)</span></p>
<p>(b): 集合中的Morgan定律:<span class="math inline">\((A\cup B)^c = A^c \cap B^c\)</span></p>
</div>
</div>
</div>
<div id="第二次作业" class="section level1">
<h1>第二次作业</h1>
<div id="section" class="section level2">
<h2>3.3</h2>
<div id="question-1" class="section level3">
<h3>Question</h3>
<p>The Pareto(a, b) distribution has cdf <span class="math display">\[F(x) = 1 - (\frac{b}{x})^a, x \geq b&gt;0,a&gt;0.\]</span></p>
<p>Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span>and use the inverse transform method to simulate a random sample from the <span class="math inline">\(Pareto(2, 2)\)</span> distribution. Graph the density histogram of the sample with the <span class="math inline">\(Pareto(2, 2)\)</span> density superimposed for comparison.</p>
</div>
<div id="answer-1" class="section level3">
<h3>Answer</h3>
<p>记<span class="math inline">\(U = F(x)=1 - (\frac{b}{x})^a\)</span>，则<span class="math inline">\(F^{-1}(U) = x = \frac{b}{(1-u)^{1/a}}\)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">a=<span class="dv">2</span>;b=<span class="dv">2</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co">##1.产生10000个随机数，并求逆</span></a>
<a class="sourceLine" id="cb1-3" title="3">u &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb1-4" title="4">x &lt;-<span class="st"> </span>b<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>a)</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co">##2.绘制直方图和函数曲线，进行对比</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">hist</span>(x, <span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>x)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)),<span class="dt">breaks =</span> <span class="dv">100</span>,<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>))</a>
<a class="sourceLine" id="cb1-7" title="7">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">lines</span>(y, <span class="dv">8</span><span class="op">/</span>y<span class="op">^</span><span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="section-1" class="section level2">
<h2>3.9</h2>
<div id="question-2" class="section level3">
<h3>Question</h3>
<p>The rescaled Epanechnikov kernel [85] is a symmetric density function <span class="math display">\[f_e(x) = \frac{3}{4}(1-x^2), |x| \leq 1. \qquad   (3.10)\]</span> Devroye and Gyorfi [71, p. 236] give the following algorithm for simulation from this distribution. Generate iid <span class="math inline">\(U1, U2, U3 \sim Uniform(−1, 1).\)</span> If <span class="math inline">\(|U3| ≥|U2|\)</span> and <span class="math inline">\(|U3|≥|U1|\)</span>, deliver <span class="math inline">\(U2\)</span>; otherwise deliver <span class="math inline">\(U3\)</span>. Write a function to generate random variates from <span class="math inline">\(f_e\)</span>, and construct the histogram density estimate of a large simulated random sample.</p>
</div>
<div id="answer-2" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co">##1.产生一个随机数数据框，每一列代表一组随机数</span></a>
<a class="sourceLine" id="cb2-2" title="2">n =<span class="st"> </span><span class="dv">100000</span></a>
<a class="sourceLine" id="cb2-3" title="3">randomDf &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">matrix</span>(<span class="kw">runif</span>(n<span class="op">*</span><span class="dv">3</span>)<span class="op">*</span><span class="dv">2-1</span>,<span class="dt">nrow=</span>n,<span class="dt">ncol=</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="kw">names</span>(randomDf) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;U1&#39;</span>,<span class="st">&#39;U2&#39;</span>,<span class="st">&#39;U3&#39;</span>)</a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">##2.自定义函数，构造取数逻辑</span></a>
<a class="sourceLine" id="cb2-6" title="6">DeliverFun &lt;-<span class="st"> </span><span class="cf">function</span>(randomDf,c1,c2,c3) {</a>
<a class="sourceLine" id="cb2-7" title="7">  deliverNum &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">abs</span>(randomDf[c3])<span class="op">&gt;=</span><span class="kw">max</span>(<span class="kw">abs</span>(randomDf[c1]),<span class="kw">abs</span>(randomDf[c2])),randomDf[c2],randomDf[c3])</a>
<a class="sourceLine" id="cb2-8" title="8">  <span class="kw">return</span>(deliverNum)</a>
<a class="sourceLine" id="cb2-9" title="9">}</a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">##3.取数，并绘制直方图</span></a>
<a class="sourceLine" id="cb2-11" title="11">DeliverNums &lt;-<span class="st"> </span><span class="kw">apply</span>(randomDf,<span class="dv">1</span>,DeliverFun,<span class="dt">c1=</span><span class="st">&#39;U1&#39;</span>,<span class="dt">c2=</span><span class="st">&#39;U2&#39;</span>,<span class="dt">c3=</span><span class="st">&#39;U3&#39;</span>)</a>
<a class="sourceLine" id="cb2-12" title="12"><span class="kw">hist</span>(DeliverNums, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x) <span class="op">==</span><span class="st"> </span><span class="dv">3</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">4</span>), <span class="dt">prob=</span>T)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="section-2" class="section level2">
<h2>3.10</h2>
<div id="question-3" class="section level3">
<h3>Question</h3>
<p>Prove that the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_e \quad (3.10).\)</span></p>
</div>
<div id="answer-3" class="section level3">
<h3>Answer</h3>
<p>记</p>
<p><span class="math display">\[\begin{align*}
\begin{split}
X=\left \{
\begin{array}{ll}
U_2,\quad IF \quad |U_3| \geq|U_2| and |U_3|\geq|U_1| \\
U_3,\quad Otherwise.
\end{array}
\right.
\end{split}
\end{align*}\]</span> 记事件 <span class="math display">\[A = \{|U_3| \geq|U_2| and |U_3|\geq|U_1|\}\]</span></p>
<p>则 <span class="math display">\[P(X \leq x) = P(U_2\leq x,A)+P(U_3\leq x,A^c)\]</span> 其中 <span class="math display">\[P(U_2\leq x,A)=\iiint_{\{U_2 \leq x,A\}}\frac{1}{8}du_1du_2du_3=\frac{1}{8}\int_{-1}^xdu_2(\int_{-1}^{-|u_2|}du_3+\int_{|u_2|}^{1}du_3)\int_{-|u_3|}^{|u_3|}du_1 =-\frac{1}{12}x^3+\frac{1}{4}x+\frac{1}{6}\]</span> <span class="math display">\[P(U_3\leq x,A^c)=P(U_3 \leq x)-P(U_3 \leq x,A)=\frac{x+1}{2}-\frac{1}{8}\int_{-1}^xdu_3\int_{-|u_3|}^{|u_3|}du_1\int_{-|u_3|}^{|u_3|}du_2=-\frac{1}{6}x^3+\frac{1}{2}x+\frac{1}{3}\]</span> 所以 <span class="math display">\[P(X \leq x) = -\frac{1}{4}x^3+\frac{3}{4}x+\frac{1}{2}\]</span> 密度函数 <span class="math display">\[f(x)=\frac{3}{4}(1-x^2),\quad |x|\leq 1\]</span> 得证.</p>
</div>
</div>
<div id="section-3" class="section level2">
<h2>3.13</h2>
<div id="question-4" class="section level3">
<h3>Question</h3>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf <span class="math display">\[F(y) = 1-(\frac{\beta}{\beta+y})^r,\quad y \geq 0.\]</span> (This is an alternative parameterization of the Pareto cdf given in Exercise 3.3.) Generate 1000 random observations from the mixture with r = 4 and β = 2. Compare the empirical and theoretical (Pareto) distributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</p>
</div>
<div id="answer-4" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co">##1.通过逆方法生成样本</span></a>
<a class="sourceLine" id="cb3-2" title="2">u &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb3-3" title="3">x &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>)<span class="op">-</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">##2.绘制直方图和函数曲线图</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="kw">hist</span>(x,<span class="dt">prob=</span>T,<span class="dt">breaks =</span> <span class="dv">100</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">64</span><span class="op">/</span>(y<span class="op">+</span><span class="dv">2</span>)<span class="op">^</span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb3-6" title="6">y =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb3-7" title="7"><span class="kw">lines</span>(y,<span class="dv">64</span><span class="op">/</span>(y<span class="op">+</span><span class="dv">2</span>)<span class="op">^</span><span class="dv">5</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="第三次作业" class="section level1">
<h1>第三次作业</h1>
<div id="excercise-5.1" class="section level2">
<h2>Excercise-5.1</h2>
<p>Compute a Monte Carlo estimate of <span class="math display">\[\int_0^{\pi/3} \sin t dt\]</span> and compare your estimate with the exact value of the integral.</p>
<div id="answer-5.1" class="section level3">
<h3>Answer-5.1</h3>
<p>做转化： <span class="math display">\[\int_0^{\pi/3} \sin t dt=\int_0^{\pi/3}\frac{\pi}{3}\sin t \frac{3}{\pi}dt=E[\frac{\pi}{3} \sin(Y)],Y\sim U(0, \frac{\pi}{3})\]</span></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># 生成满足U(0,pi/3)的随机数</span></a>
<a class="sourceLine" id="cb4-2" title="2">n &lt;-<span class="st"> </span><span class="dv">1000000</span></a>
<a class="sourceLine" id="cb4-3" title="3">randNums &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dv">0</span>, pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb4-4" title="4"></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co"># 用样本均值去估计期望</span></a>
<a class="sourceLine" id="cb4-6" title="6">resOfMC &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(randNums)<span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb4-7" title="7"></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co"># 用数学分析方法得到的结果</span></a>
<a class="sourceLine" id="cb4-9" title="9">resOfAnalytic &lt;-<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb4-10" title="10"></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="co"># 打印</span></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="kw">print</span>(<span class="kw">round</span>(resOfMC,<span class="dv">4</span>))</a></code></pre></div>
<pre><code>## [1] 0.5</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">print</span>(<span class="kw">round</span>(resOfAnalytic,<span class="dv">4</span>))</a></code></pre></div>
<pre><code>## [1] 0.5</code></pre>
<p><strong>可见MC方法所得结果与实际结果十分相近</strong></p>
</div>
</div>
<div id="exercise-5.7" class="section level2">
<h2>Exercise-5.7</h2>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6.</p>
<div id="answer-5.7" class="section level3">
<h3>Answer-5.7</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># 生成满足U(0,1)的随机数</span></a>
<a class="sourceLine" id="cb8-2" title="2">n &lt;-<span class="st"> </span><span class="dv">1000000</span></a>
<a class="sourceLine" id="cb8-3" title="3">randNums &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb8-4" title="4"></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co"># Simple MC</span></a>
<a class="sourceLine" id="cb8-6" title="6">y1 &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">^</span>randNums</a>
<a class="sourceLine" id="cb8-7" title="7">meanOfSimpleMC &lt;-<span class="st"> </span><span class="kw">mean</span>(y1)</a>
<a class="sourceLine" id="cb8-8" title="8">varOfSimpleMC &lt;-<span class="st"> </span><span class="kw">var</span>(y1)</a>
<a class="sourceLine" id="cb8-9" title="9"></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="co"># Antithetic MC</span></a>
<a class="sourceLine" id="cb8-11" title="11">y2 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span>(<span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">^</span>randNums<span class="op">+</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">-</span>randNums))</a>
<a class="sourceLine" id="cb8-12" title="12">meanOfAntitheticMC &lt;-<span class="st"> </span><span class="kw">mean</span>(y2)</a>
<a class="sourceLine" id="cb8-13" title="13">varOfAntitheticMC &lt;-<span class="st"> </span><span class="kw">var</span>(y2)</a>
<a class="sourceLine" id="cb8-14" title="14"></a>
<a class="sourceLine" id="cb8-15" title="15"><span class="co"># Empirical  percent reduction in variance of theta_hat.</span></a>
<a class="sourceLine" id="cb8-16" title="16">empReduceOfVar &lt;-<span class="st"> </span>(varOfSimpleMC <span class="op">-</span><span class="st"> </span>varOfAntitheticMC)<span class="op">/</span>varOfSimpleMC</a>
<a class="sourceLine" id="cb8-17" title="17"></a>
<a class="sourceLine" id="cb8-18" title="18"><span class="co"># Theoretical percent reduction in variance of theta_hat.</span></a>
<a class="sourceLine" id="cb8-19" title="19">TheoReduceOfVar &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">/</span><span class="dv">4</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">-</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">4</span>)<span class="op">/</span>(<span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb8-20" title="20"></a>
<a class="sourceLine" id="cb8-21" title="21"><span class="co"># print</span></a>
<a class="sourceLine" id="cb8-22" title="22"><span class="kw">print</span>(<span class="kw">round</span>(meanOfSimpleMC,<span class="dv">5</span>))</a></code></pre></div>
<pre><code>## [1] 1.71808</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">print</span>(<span class="kw">round</span>(meanOfAntitheticMC,<span class="dv">5</span>)) </a></code></pre></div>
<pre><code>## [1] 1.71827</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">print</span>(<span class="kw">round</span>(empReduceOfVar,<span class="dv">5</span>))</a></code></pre></div>
<pre><code>## [1] 0.98384</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">print</span>(<span class="kw">round</span>(TheoReduceOfVar,<span class="dv">5</span>))</a></code></pre></div>
<pre><code>## [1] 0.98384</code></pre>
</div>
</div>
<div id="exercise-5.11" class="section level2">
<h2>Exercise-5.11</h2>
<p>If <span class="math inline">\(\hat{\theta}_1\)</span> and <span class="math inline">\(\hat{\theta}_2\)</span> are unbiased estimators of <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\hat\theta_1\)</span> and <span class="math inline">\(\hat\theta_2\)</span> are antithetic, we derived that <span class="math inline">\(c^*\)</span> = 1/2 is the optimal constant that minimizes the variance of <span class="math inline">\(\hat\theta_c = c \hat\theta_1+(1-c)\hat\theta_2\)</span>. Derive <span class="math inline">\(c^*\)</span> for the general case. That is, if <span class="math inline">\(\hat\theta_1\)</span> and <span class="math inline">\(\hat\theta_2\)</span> are any two unbiased estimators of <span class="math inline">\(\theta\)</span>, find the value <span class="math inline">\(c^*\)</span> that minimizes the variance of the estimator <span class="math inline">\(\hat\theta_c = c \hat\theta_1+(1-c)\hat\theta_2\)</span> in equation (5.11). (<span class="math inline">\(c^*\)</span> will be a function of the variances and the covariance of the estimators.)</p>
<div id="answer-5.11" class="section level3">
<h3>Answer-5.11</h3>
<p><span class="math display">\[Var(\hat\theta_c) = c^2Var\hat\theta_1 +(1-c)^2Var\hat\theta_2+2c(1-c)Cov(\hat\theta_1,\hat\theta_2) = Var(\hat\theta_1-\hat\theta_2)c^2+2(Cov(\hat\theta_1,\hat\theta_2)-Var\hat\theta_2)c+Var\hat\theta_2\]</span></p>
<p>可看作c的函数，易得：<span class="math inline">\(c^* = \frac{Var\hat\theta_2-Cov(\hat\theta_1,\hat\theta_2)}{Var(\hat\theta_1-\hat\theta_2)}\)</span></p>
</div>
</div>
</div>
<div id="第四次作业" class="section level1">
<h1>第四次作业</h1>
<div id="exercise-5.13" class="section level2">
<h2>Exercise 5.13</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span>and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math inline">\(g(x)=\frac{x^2}{\sqrt{2\pi}} e^{-x^2/2},\quad x&gt;1.\)</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math inline">\(\int_1^\infty \frac{x^2}{\sqrt{2 \pi}} e^{-x^2/2} dx\)</span> by importance sampling? Explain.</p>
<div id="answer-5" class="section level3">
<h3>Answer</h3>
<p><span class="math inline">\(f_1(x)=e^{0.5} x e^{-x^2/2},\quad x&gt;1 \\ f_2(x)=9/x^{10},\quad x&gt;1\)</span></p>
<p>作图如下：</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co"># x轴</span></a>
<a class="sourceLine" id="cb16-2" title="2">xaxis &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb16-3" title="3"><span class="co"># f</span></a>
<a class="sourceLine" id="cb16-4" title="4">f &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>xaxis<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>xaxis<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(pi<span class="op">*</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb16-5" title="5"><span class="co"># f1</span></a>
<a class="sourceLine" id="cb16-6" title="6">f1 &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="fl">0.5</span>)<span class="op">*</span>xaxis<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>xaxis<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb16-7" title="7"><span class="co">#f2</span></a>
<a class="sourceLine" id="cb16-8" title="8">f2 &lt;-<span class="st"> </span><span class="dv">9</span><span class="op">/</span>xaxis<span class="op">^</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb16-9" title="9"></a>
<a class="sourceLine" id="cb16-10" title="10"><span class="co">#作图</span></a>
<a class="sourceLine" id="cb16-11" title="11"><span class="kw">plot</span>(xaxis,f,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>)</a>
<a class="sourceLine" id="cb16-12" title="12"><span class="kw">lines</span>(xaxis,f1,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</a>
<a class="sourceLine" id="cb16-13" title="13"><span class="kw">lines</span>(xaxis,f2,<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>可见f1与f贴合较好，产生的方差比f2小。</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co"># 满足U(0,1)的样本</span></a>
<a class="sourceLine" id="cb17-2" title="2">u &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb17-3" title="3"></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="co"># 逆方法求f1的样本</span></a>
<a class="sourceLine" id="cb17-5" title="5">sampleOfF1 &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1-2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))</a>
<a class="sourceLine" id="cb17-6" title="6"></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="co">#importance MC using f1</span></a>
<a class="sourceLine" id="cb17-8" title="8">resultOfF1 &lt;-<span class="st"> </span>sampleOfF1<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">/</span><span class="kw">exp</span>(<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb17-9" title="9">meanOfF1 &lt;-<span class="st"> </span><span class="kw">mean</span>(resultOfF1)</a>
<a class="sourceLine" id="cb17-10" title="10">varOfF1 &lt;-<span class="st"> </span><span class="kw">var</span>(resultOfF1)</a>
<a class="sourceLine" id="cb17-11" title="11"></a>
<a class="sourceLine" id="cb17-12" title="12"><span class="co"># 逆方法求f2的样本</span></a>
<a class="sourceLine" id="cb17-13" title="13">sampleOfF2 &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">9</span>)</a>
<a class="sourceLine" id="cb17-14" title="14"></a>
<a class="sourceLine" id="cb17-15" title="15"><span class="co"># importance MC using f2</span></a>
<a class="sourceLine" id="cb17-16" title="16">resultOfF2 &lt;-<span class="st"> </span>sampleOfF2<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>sampleOfF2<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">/</span>(<span class="dv">9</span><span class="op">/</span>sampleOfF2<span class="op">^</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb17-17" title="17">meanOfF2 &lt;-<span class="st"> </span><span class="kw">mean</span>(resultOfF2)</a>
<a class="sourceLine" id="cb17-18" title="18">varOfF2 &lt;-<span class="st"> </span><span class="kw">var</span>(resultOfF2)</a>
<a class="sourceLine" id="cb17-19" title="19"></a>
<a class="sourceLine" id="cb17-20" title="20"><span class="co"># print</span></a>
<a class="sourceLine" id="cb17-21" title="21"><span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&#39;variance of f1 is &#39;</span>,<span class="kw">round</span>(varOfF1,<span class="dv">4</span>),<span class="st">&quot;;&quot;</span>,<span class="st">&quot;variance of f2 is &quot;</span>,<span class="kw">round</span>(varOfF2,<span class="dv">4</span>)))</a></code></pre></div>
<pre><code>## [1] &quot;variance of f1 is 0.0151;variance of f2 is 24.2854&quot;</code></pre>
</div>
</div>
<div id="exercise-5.15" class="section level2">
<h2>Exercise 5.15</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
<div id="answer-6" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="co"># number of replicates</span></a>
<a class="sourceLine" id="cb19-2" title="2">numOfRep &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb19-3" title="3"></a>
<a class="sourceLine" id="cb19-4" title="4"></a>
<a class="sourceLine" id="cb19-5" title="5"><span class="co"># 利用f(x)的分布函数求出分位点函数</span></a>
<a class="sourceLine" id="cb19-6" title="6">quantileFunc &lt;-<span class="st"> </span><span class="cf">function</span>(alpha) {</a>
<a class="sourceLine" id="cb19-7" title="7">  <span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)) <span class="op">*</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb19-8" title="8">}</a>
<a class="sourceLine" id="cb19-9" title="9"></a>
<a class="sourceLine" id="cb19-10" title="10"></a>
<a class="sourceLine" id="cb19-11" title="11"><span class="co"># stratified方法分层数</span></a>
<a class="sourceLine" id="cb19-12" title="12">Strata &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb19-13" title="13"></a>
<a class="sourceLine" id="cb19-14" title="14"><span class="co"># 用于对照importance sampling和stratified importance sampling的矩阵</span></a>
<a class="sourceLine" id="cb19-15" title="15">comparisonMatrix &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb19-16" title="16"></a>
<a class="sourceLine" id="cb19-17" title="17"><span class="co"># 函数g(x)</span></a>
<a class="sourceLine" id="cb19-18" title="18">g &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb19-19" title="19">  <span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">^</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb19-20" title="20">}</a>
<a class="sourceLine" id="cb19-21" title="21"></a>
<a class="sourceLine" id="cb19-22" title="22"><span class="co"># 自定义函数：用于生成服从f(x)或者5f(x)的分布的样本</span></a>
<a class="sourceLine" id="cb19-23" title="23">samplingFromF &lt;-<span class="st"> </span><span class="cf">function</span>(num, min, max, par) {</a>
<a class="sourceLine" id="cb19-24" title="24">  <span class="co"># 使用逆方法生成服从f(x)分布的随机数</span></a>
<a class="sourceLine" id="cb19-25" title="25">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(num, <span class="dt">min=</span>min, <span class="dt">max=</span>max)</a>
<a class="sourceLine" id="cb19-26" title="26">  <span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>min)<span class="op">-</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)) <span class="op">*</span><span class="st"> </span>u<span class="op">/</span>par)</a>
<a class="sourceLine" id="cb19-27" title="27">}</a>
<a class="sourceLine" id="cb19-28" title="28"></a>
<a class="sourceLine" id="cb19-29" title="29"><span class="co"># 计算积分</span></a>
<a class="sourceLine" id="cb19-30" title="30"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>) {</a>
<a class="sourceLine" id="cb19-31" title="31"></a>
<a class="sourceLine" id="cb19-32" title="32"></a>
<a class="sourceLine" id="cb19-33" title="33">  <span class="co"># importance方法得到的结果存入矩阵中</span></a>
<a class="sourceLine" id="cb19-34" title="34">  comparisonMatrix[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>((<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span>(<span class="kw">samplingFromF</span>(numOfRep,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">par=</span><span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb19-35" title="35"></a>
<a class="sourceLine" id="cb19-36" title="36">  <span class="co"># 使用statified importance方法</span></a>
<a class="sourceLine" id="cb19-37" title="37">  Strata[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>((<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span>(<span class="kw">samplingFromF</span>(numOfRep<span class="op">/</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="kw">quantileFunc</span>(<span class="fl">0.2</span>),<span class="dv">5</span>)<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))<span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb19-38" title="38">  Strata[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>((<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span>(<span class="kw">samplingFromF</span>(numOfRep<span class="op">/</span><span class="dv">5</span>,<span class="kw">quantileFunc</span>(<span class="fl">0.2</span>),<span class="kw">quantileFunc</span>(<span class="fl">0.4</span>),<span class="dv">5</span>)<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))<span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb19-39" title="39">  Strata[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>((<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span>(<span class="kw">samplingFromF</span>(numOfRep<span class="op">/</span><span class="dv">5</span>,<span class="kw">quantileFunc</span>(<span class="fl">0.4</span>),<span class="kw">quantileFunc</span>(<span class="fl">0.6</span>),<span class="dv">5</span>)<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))<span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb19-40" title="40">  Strata[<span class="dv">4</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>((<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span>(<span class="kw">samplingFromF</span>(numOfRep<span class="op">/</span><span class="dv">5</span>,<span class="kw">quantileFunc</span>(<span class="fl">0.6</span>),<span class="kw">quantileFunc</span>(<span class="fl">0.8</span>),<span class="dv">5</span>)<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))<span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb19-41" title="41">  Strata[<span class="dv">5</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>((<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span>(<span class="kw">samplingFromF</span>(numOfRep<span class="op">/</span><span class="dv">5</span>,<span class="kw">quantileFunc</span>(<span class="fl">0.8</span>),<span class="kw">quantileFunc</span>(<span class="dv">1</span>),<span class="dv">5</span>)<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))<span class="op">/</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb19-42" title="42">  comparisonMatrix[i, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sum</span>(Strata)</a>
<a class="sourceLine" id="cb19-43" title="43">}</a>
<a class="sourceLine" id="cb19-44" title="44"></a>
<a class="sourceLine" id="cb19-45" title="45"></a>
<a class="sourceLine" id="cb19-46" title="46"><span class="co"># 对比均值</span></a>
<a class="sourceLine" id="cb19-47" title="47"><span class="kw">apply</span>(comparisonMatrix,<span class="dv">2</span>,mean)</a></code></pre></div>
<pre><code>## [1] 0.5250254 0.5203666</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="co"># 对比方差</span></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="kw">apply</span>(comparisonMatrix,<span class="dv">2</span>, var)</a></code></pre></div>
<pre><code>## [1] 8.282507e-06 2.518553e-08</code></pre>
</div>
</div>
<div id="exercise-6.4" class="section level2">
<h2>Exercise 6.4</h2>
<p>Suppose that <span class="math inline">\(X_1,X_2,\dots X_n\)</span> are a random sample from a from a lognormal distribution with unknown parameters. Construct a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</p>
<div id="answer-7" class="section level3">
<h3>Answer</h3>
<p><span class="math inline">\(X_1,X_2,\dots X_n \sim lognormal(\mu,\sigma), \text{记}Y_i=\log(X_i),\text{则:}\\Y_1,Y_2,\dots Y_n \sim Normal(\mu,\sigma^2) \\ \text{故：}\frac{\sqrt n (\bar Y-\mu)}{\sigma} \sim N(0,1) \\ \text{所以}，\mu\text{的95%CI为：} [\frac{1}{n} \sum\limits_{i=1}^n \log X_i-u_{1-\alpha /2}\sigma/{\sqrt n},\frac{1}{n} \sum\limits_{i=1}^n \log X_i -u_{\alpha/2}\sigma / \sqrt n]\)</span></p>
<p>下面用程序模拟生成lognormal(0,1)分布的mu的估计的95%置信区间：</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">mu &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb23-2" title="2">sigma &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb23-3" title="3"></a>
<a class="sourceLine" id="cb23-4" title="4">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb23-5" title="5">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb23-6" title="6"></a>
<a class="sourceLine" id="cb23-7" title="7">x &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(n,mu,sigma)</a>
<a class="sourceLine" id="cb23-8" title="8"><span class="co">## 区间上界</span></a>
<a class="sourceLine" id="cb23-9" title="9">UCL &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">log</span>(x))<span class="op">-</span><span class="kw">qnorm</span>(alpha<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>sigma<span class="op">/</span><span class="kw">sqrt</span>(n)</a>
<a class="sourceLine" id="cb23-10" title="10"><span class="co">## 区间下界</span></a>
<a class="sourceLine" id="cb23-11" title="11">DCL &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">log</span>(x))<span class="op">-</span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>sigma<span class="op">/</span><span class="kw">sqrt</span>(n)</a>
<a class="sourceLine" id="cb23-12" title="12"><span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&quot;[&quot;</span>,DCL,<span class="st">&quot;  ,  &quot;</span>,UCL,<span class="st">&quot;]&quot;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;[-0.194791465277407  ,  0.681731075299174]&quot;</code></pre>
<p>下面采用MC去估计alpha</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">mu &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb25-2" title="2">sigma &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb25-3" title="3"></a>
<a class="sourceLine" id="cb25-4" title="4">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb25-5" title="5">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb25-6" title="6"></a>
<a class="sourceLine" id="cb25-7" title="7">k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb25-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>) {</a>
<a class="sourceLine" id="cb25-9" title="9">  x &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(n,mu, sigma)</a>
<a class="sourceLine" id="cb25-10" title="10">  <span class="co">## 区间上界</span></a>
<a class="sourceLine" id="cb25-11" title="11">  UCL &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">log</span>(x))<span class="op">-</span><span class="kw">qnorm</span>(alpha<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>sigma<span class="op">/</span><span class="kw">sqrt</span>(n)</a>
<a class="sourceLine" id="cb25-12" title="12">  <span class="co">## 区间下界</span></a>
<a class="sourceLine" id="cb25-13" title="13">  DCL &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">log</span>(x))<span class="op">-</span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>sigma<span class="op">/</span><span class="kw">sqrt</span>(n)</a>
<a class="sourceLine" id="cb25-14" title="14">  <span class="co">## 若mu在区间中则k加1，否则加0</span></a>
<a class="sourceLine" id="cb25-15" title="15">  <span class="cf">if</span> (mu<span class="op">&lt;</span>UCL <span class="op">&amp;&amp;</span><span class="st"> </span>mu<span class="op">&gt;</span>DCL) {</a>
<a class="sourceLine" id="cb25-16" title="16">    k=k<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb25-17" title="17">  }</a>
<a class="sourceLine" id="cb25-18" title="18">}</a>
<a class="sourceLine" id="cb25-19" title="19">alphaHat &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="st"> </span>k<span class="op">/</span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb25-20" title="20"><span class="kw">print</span>(alphaHat)</a></code></pre></div>
<pre><code>## [1] 0.043</code></pre>
</div>
</div>
<div id="exercise-6.5" class="section level2">
<h2>Exercise 6.5</h2>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb27-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb27-3" title="3"></a>
<a class="sourceLine" id="cb27-4" title="4">k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb27-5" title="5"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>) {</a>
<a class="sourceLine" id="cb27-6" title="6">  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb27-7" title="7"></a>
<a class="sourceLine" id="cb27-8" title="8">  UCL =<span class="st"> </span><span class="kw">mean</span>(x)<span class="op">-</span><span class="kw">sd</span>(x)<span class="op">*</span><span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df=</span>n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</a>
<a class="sourceLine" id="cb27-9" title="9">  DCL =<span class="st"> </span><span class="kw">mean</span>(x)<span class="op">-</span><span class="kw">sd</span>(x)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df=</span>n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</a>
<a class="sourceLine" id="cb27-10" title="10"></a>
<a class="sourceLine" id="cb27-11" title="11">  <span class="cf">if</span> (UCL <span class="op">&gt;</span><span class="dv">2</span> <span class="op">&amp;&amp;</span><span class="st"> </span>DCL <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>) {</a>
<a class="sourceLine" id="cb27-12" title="12">    k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb27-13" title="13">  }</a>
<a class="sourceLine" id="cb27-14" title="14">}</a>
<a class="sourceLine" id="cb27-15" title="15"></a>
<a class="sourceLine" id="cb27-16" title="16"><span class="kw">print</span>(k<span class="op">/</span><span class="dv">1000</span>)</a></code></pre></div>
<pre><code>## [1] 0.901</code></pre>
</div>
</div>
<div id="第五次作业" class="section level1">
<h1>第五次作业</h1>
<div id="question-6.7" class="section level2">
<h2>Question 6.7</h2>
<p>Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(Beta(\alpha,\alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(\nu)\)</span>?</p>
<div id="answer-8" class="section level3">
<h3>Answer</h3>
<div id="normality-against-symmetric-betathetatheta" class="section level4">
<h4>1.Normality Against Symmetric Beta(theta,theta)</h4>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="co">## 取每次抽样的样本容量为20，置信系数取0.05，定出拒绝域.</span></a>
<a class="sourceLine" id="cb29-2" title="2">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb29-3" title="3">r &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">3</span>)))</a>
<a class="sourceLine" id="cb29-4" title="4"></a>
<a class="sourceLine" id="cb29-5" title="5"><span class="co">## 函数：计算样本偏度系数</span></a>
<a class="sourceLine" id="cb29-6" title="6">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb29-7" title="7">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb29-8" title="8">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb29-9" title="9">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb29-10" title="10">  <span class="kw">return</span>( m3<span class="op">/</span>m2<span class="op">^</span><span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb29-11" title="11">}</a>
<a class="sourceLine" id="cb29-12" title="12"></a>
<a class="sourceLine" id="cb29-13" title="13"></a>
<a class="sourceLine" id="cb29-14" title="14"><span class="co">## 取Beta分布的参数变化范围为1：100</span></a>
<a class="sourceLine" id="cb29-15" title="15">theta &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">20</span>),<span class="kw">seq</span>(<span class="dv">101</span>,<span class="dv">1012</span>,<span class="dv">100</span>))</a>
<a class="sourceLine" id="cb29-16" title="16"></a>
<a class="sourceLine" id="cb29-17" title="17"></a>
<a class="sourceLine" id="cb29-18" title="18"><span class="co">## 对每个theta[i]，计算功效</span></a>
<a class="sourceLine" id="cb29-19" title="19">rate &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(theta))</a>
<a class="sourceLine" id="cb29-20" title="20"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(theta)) {</a>
<a class="sourceLine" id="cb29-21" title="21">  e &lt;-<span class="st"> </span>theta[i]</a>
<a class="sourceLine" id="cb29-22" title="22">  k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb29-23" title="23">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>) {</a>
<a class="sourceLine" id="cb29-24" title="24">    sampleFromBeta &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n,e,e)</a>
<a class="sourceLine" id="cb29-25" title="25">    <span class="co">### 样本落在拒绝域，k&lt;-k+1</span></a>
<a class="sourceLine" id="cb29-26" title="26">    <span class="cf">if</span> (<span class="kw">abs</span>(<span class="kw">sk</span>(sampleFromBeta))<span class="op">&gt;</span>r){</a>
<a class="sourceLine" id="cb29-27" title="27">      k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb29-28" title="28">    }</a>
<a class="sourceLine" id="cb29-29" title="29">  }</a>
<a class="sourceLine" id="cb29-30" title="30">  rate[i] &lt;-<span class="st"> </span>k<span class="op">/</span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb29-31" title="31"></a>
<a class="sourceLine" id="cb29-32" title="32">}</a>
<a class="sourceLine" id="cb29-33" title="33"></a>
<a class="sourceLine" id="cb29-34" title="34"><span class="co">## 作功效图</span></a>
<a class="sourceLine" id="cb29-35" title="35"><span class="kw">plot</span>(theta,rate,<span class="dt">type=</span><span class="st">&#39;b&#39;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb29-36" title="36"><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">0.05</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>,<span class="dt">lty=</span><span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> <span class="math inline">\(H_0:X\sim N(\mu,\sigma) \quad \text{vs} \quad H_1:X \sim Beta(\theta,\theta).\)</span></p>
<p>功效很小，犯第二类错误的概率比较大，检验很难达到显著。即通过偏度检验无法区分开正态和<span class="math inline">\(Beta(\theta,\theta)\)</span></p>
</div>
<div id="normality-against-symmetric-ttheta." class="section level4">
<h4>2.Normality Against Symmetric t(theta).</h4>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="co">## r代码基本同上</span></a>
<a class="sourceLine" id="cb30-2" title="2">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb30-3" title="3">r &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">3</span>)))</a>
<a class="sourceLine" id="cb30-4" title="4"></a>
<a class="sourceLine" id="cb30-5" title="5"></a>
<a class="sourceLine" id="cb30-6" title="6">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb30-7" title="7">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb30-8" title="8">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb30-9" title="9">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb30-10" title="10">  <span class="kw">return</span>( m3<span class="op">/</span>m2<span class="op">^</span><span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb30-11" title="11">}</a>
<a class="sourceLine" id="cb30-12" title="12"></a>
<a class="sourceLine" id="cb30-13" title="13">theta &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">1</span>),<span class="kw">seq</span>(<span class="dv">11</span>,<span class="dv">100</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb30-14" title="14"></a>
<a class="sourceLine" id="cb30-15" title="15">rate &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(theta))</a>
<a class="sourceLine" id="cb30-16" title="16"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(theta)) {</a>
<a class="sourceLine" id="cb30-17" title="17">  e &lt;-<span class="st"> </span>theta[i]</a>
<a class="sourceLine" id="cb30-18" title="18">  k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb30-19" title="19">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>) {</a>
<a class="sourceLine" id="cb30-20" title="20">    sampleFromBeta &lt;-<span class="st"> </span><span class="kw">rt</span>(n,e)</a>
<a class="sourceLine" id="cb30-21" title="21">    <span class="cf">if</span> (<span class="kw">abs</span>(<span class="kw">sk</span>(sampleFromBeta))<span class="op">&gt;</span>r){</a>
<a class="sourceLine" id="cb30-22" title="22">      k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb30-23" title="23">    }</a>
<a class="sourceLine" id="cb30-24" title="24">  }</a>
<a class="sourceLine" id="cb30-25" title="25">  rate[i] &lt;-<span class="st"> </span>k<span class="op">/</span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb30-26" title="26"></a>
<a class="sourceLine" id="cb30-27" title="27">}</a>
<a class="sourceLine" id="cb30-28" title="28"><span class="kw">plot</span>(theta,rate,<span class="dt">type=</span><span class="st">&#39;b&#39;</span>)</a>
<a class="sourceLine" id="cb30-29" title="29"><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">0.05</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>,<span class="dt">lty=</span><span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>可见功效随theta的增加而下降,且在大概theta&lt;100时基本都可以达到显著.</p>
</div>
</div>
</div>
<div id="qustion-6.8" class="section level2">
<h2>Qustion 6.8</h2>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the F test of equal variance, at significance level <span class="math inline">\(\alpha\)</span>=0.055. Compare the power of the Count Five test and F test for small, medium, and large sample sizes. (Recall that the F test is not applicable for non-normal distributions.)</p>
<div id="answer-9" class="section level3">
<h3>Answer</h3>
<div id="count-five" class="section level4">
<h4>1.Count Five</h4>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb31-2" title="2">sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></a>
<a class="sourceLine" id="cb31-3" title="3"></a>
<a class="sourceLine" id="cb31-4" title="4">maxout &lt;-<span class="st"> </span><span class="cf">function</span>(sampleX,sampleY) {</a>
<a class="sourceLine" id="cb31-5" title="5">  centerX &lt;-<span class="st"> </span>sampleX<span class="op">-</span><span class="kw">mean</span>(sampleX)</a>
<a class="sourceLine" id="cb31-6" title="6">  centerY &lt;-<span class="st"> </span>sampleY<span class="op">-</span><span class="kw">mean</span>(sampleY)</a>
<a class="sourceLine" id="cb31-7" title="7"></a>
<a class="sourceLine" id="cb31-8" title="8">  outX &lt;-<span class="st"> </span><span class="kw">sum</span>(centerX<span class="op">&gt;</span><span class="kw">max</span>(centerY)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(centerX <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(centerY))</a>
<a class="sourceLine" id="cb31-9" title="9">  outY &lt;-<span class="st"> </span><span class="kw">sum</span>(centerY<span class="op">&gt;</span><span class="kw">max</span>(centerX)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(centerY <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(centerX))</a>
<a class="sourceLine" id="cb31-10" title="10">  <span class="kw">return</span>(<span class="kw">max</span>(outX,outY))</a>
<a class="sourceLine" id="cb31-11" title="11">}</a>
<a class="sourceLine" id="cb31-12" title="12"></a>
<a class="sourceLine" id="cb31-13" title="13">m &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb31-14" title="14"></a>
<a class="sourceLine" id="cb31-15" title="15">nList &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">30</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb31-16" title="16"></a>
<a class="sourceLine" id="cb31-17" title="17">pRejectOfCF &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(nList))</a>
<a class="sourceLine" id="cb31-18" title="18"></a>
<a class="sourceLine" id="cb31-19" title="19"><span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(nList)) {</a>
<a class="sourceLine" id="cb31-20" title="20">  k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb31-21" title="21">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb31-22" title="22">    x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(nList[index],<span class="dv">0</span>,sigma1)</a>
<a class="sourceLine" id="cb31-23" title="23">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(nList[index],<span class="dv">0</span>,sigma2)</a>
<a class="sourceLine" id="cb31-24" title="24"></a>
<a class="sourceLine" id="cb31-25" title="25">    <span class="cf">if</span> (<span class="kw">maxout</span>(x,y) <span class="op">&gt;</span><span class="dv">5</span>) {</a>
<a class="sourceLine" id="cb31-26" title="26">      k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb31-27" title="27">    }</a>
<a class="sourceLine" id="cb31-28" title="28">  }</a>
<a class="sourceLine" id="cb31-29" title="29">  pRejectOfCF[index] &lt;-<span class="st"> </span>k<span class="op">/</span>m</a>
<a class="sourceLine" id="cb31-30" title="30">}</a></code></pre></div>
</div>
<div id="f-test" class="section level4">
<h4>2.F test</h4>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1">m &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb32-2" title="2"></a>
<a class="sourceLine" id="cb32-3" title="3">sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb32-4" title="4">sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></a>
<a class="sourceLine" id="cb32-5" title="5"></a>
<a class="sourceLine" id="cb32-6" title="6"></a>
<a class="sourceLine" id="cb32-7" title="7">nList &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">30</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb32-8" title="8">pRejectOfF &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(nList))</a>
<a class="sourceLine" id="cb32-9" title="9"></a>
<a class="sourceLine" id="cb32-10" title="10"><span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(nList)) {</a>
<a class="sourceLine" id="cb32-11" title="11"></a>
<a class="sourceLine" id="cb32-12" title="12">  n &lt;-<span class="st"> </span>nList[index]</a>
<a class="sourceLine" id="cb32-13" title="13"></a>
<a class="sourceLine" id="cb32-14" title="14">  <span class="co">## F分布的分位数</span></a>
<a class="sourceLine" id="cb32-15" title="15">  r1 &lt;-<span class="st"> </span><span class="kw">qf</span>(<span class="fl">0.055</span><span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>,n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb32-16" title="16">  r2 &lt;-<span class="st"> </span><span class="kw">qf</span>(<span class="dv">1</span><span class="fl">-0.055</span><span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>,n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb32-17" title="17"></a>
<a class="sourceLine" id="cb32-18" title="18">  k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb32-19" title="19">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb32-20" title="20">    x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,sigma1)</a>
<a class="sourceLine" id="cb32-21" title="21">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,sigma2)</a>
<a class="sourceLine" id="cb32-22" title="22"></a>
<a class="sourceLine" id="cb32-23" title="23">    fStat &lt;-<span class="st"> </span><span class="kw">var</span>(x)<span class="op">/</span><span class="kw">var</span>(y)</a>
<a class="sourceLine" id="cb32-24" title="24"></a>
<a class="sourceLine" id="cb32-25" title="25">    <span class="cf">if</span> (fStat <span class="op">&gt;</span><span class="st"> </span>r2 <span class="op">|</span><span class="st"> </span>fStat <span class="op">&lt;</span><span class="st"> </span>r1) {</a>
<a class="sourceLine" id="cb32-26" title="26">      k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb32-27" title="27">    }</a>
<a class="sourceLine" id="cb32-28" title="28">  }</a>
<a class="sourceLine" id="cb32-29" title="29"></a>
<a class="sourceLine" id="cb32-30" title="30">  pRejectOfF[index] &lt;-<span class="st"> </span>k<span class="op">/</span>m</a>
<a class="sourceLine" id="cb32-31" title="31">}</a></code></pre></div>
</div>
<div id="compare" class="section level4">
<h4>3.Compare</h4>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">compareDF &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Count_Five=</span>pRejectOfCF, <span class="dt">F_Test=</span>pRejectOfF)</a>
<a class="sourceLine" id="cb33-2" title="2"><span class="kw">print</span>(compareDF)</a></code></pre></div>
<pre><code>##   Count_Five F_Test
## 1     0.1100 0.2120
## 2     0.4662 0.5965
## 3     0.8505 0.9832</code></pre>
</div>
</div>
</div>
<div id="question-6.c" class="section level2">
<h2>Question 6.C</h2>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math display">\[\beta_{1,d}=E[(X-\mu)^T\Sigma^{-1}(Y-\mu)]^3.\]</span> Under normality, <span class="math inline">\(\beta_{1,d} = 0\)</span>. The multivariate skewness statistic is <span class="math display">\[b_{1,d}=\frac{1}{n^2}\sum\limits_{i,j=1}^n((X_i-\bar{X})^T\hat{\Sigma}^{-1}(X_j-\bar{X}))^3,\]</span> where <span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with <span class="math inline">\(d(d + 1)(d + 2)/6\)</span> degrees of freedom.</p>
<div id="answer-10" class="section level3">
<h3>Answer</h3>
<p>以二元为例</p>
<div id="repeat-example-6.8" class="section level4">
<h4>1.Repeat Example 6.8</h4>
<p>假设要检验的样本所来自的分布为MVN(mu,Sigma)</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="co">## 维度</span></a>
<a class="sourceLine" id="cb35-2" title="2">d &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb35-3" title="3"></a>
<a class="sourceLine" id="cb35-4" title="4"><span class="co">##  总体分布</span></a>
<a class="sourceLine" id="cb35-5" title="5">mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb35-6" title="6">Sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">.8</span>, <span class="fl">.8</span>, <span class="dv">2</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb35-7" title="7"></a>
<a class="sourceLine" id="cb35-8" title="8"><span class="co">## 函数：生成多元正态r.v.</span></a>
<a class="sourceLine" id="cb35-9" title="9"><span class="co">## 函数：生成多元正态r.v.</span></a>
<a class="sourceLine" id="cb35-10" title="10">rmvn.eigen &lt;-<span class="st"> </span><span class="cf">function</span>(n, mu, Sigma) {</a>
<a class="sourceLine" id="cb35-11" title="11">  dim &lt;-<span class="st"> </span><span class="kw">length</span>(mu)</a>
<a class="sourceLine" id="cb35-12" title="12">  ev &lt;-<span class="st"> </span><span class="kw">eigen</span>(Sigma, <span class="dt">symmetric =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb35-13" title="13">  lamb &lt;-<span class="st"> </span>ev<span class="op">$</span>values</a>
<a class="sourceLine" id="cb35-14" title="14">  V &lt;-<span class="st"> </span>ev<span class="op">$</span>vectors</a>
<a class="sourceLine" id="cb35-15" title="15">  C &lt;-<span class="st"> </span>V <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(<span class="kw">sqrt</span>(lamb)) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(V)</a>
<a class="sourceLine" id="cb35-16" title="16">  Z &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n<span class="op">*</span>dim), <span class="dt">nrow =</span> n, <span class="dt">ncol =</span> d)</a>
<a class="sourceLine" id="cb35-17" title="17">  X &lt;-<span class="st"> </span>Z <span class="op">%*%</span><span class="st"> </span>C <span class="op">+</span><span class="st"> </span><span class="kw">matrix</span>(mu, n, dim, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb35-18" title="18">  <span class="kw">return</span>(X)</a>
<a class="sourceLine" id="cb35-19" title="19">}</a>
<a class="sourceLine" id="cb35-20" title="20"></a>
<a class="sourceLine" id="cb35-21" title="21"><span class="co">## reject area</span></a>
<a class="sourceLine" id="cb35-22" title="22">r &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="dv">1</span><span class="fl">-0.05</span>,<span class="dt">df=</span>d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</a>
<a class="sourceLine" id="cb35-23" title="23"></a>
<a class="sourceLine" id="cb35-24" title="24">sampleSize &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>)</a>
<a class="sourceLine" id="cb35-25" title="25"></a>
<a class="sourceLine" id="cb35-26" title="26">m &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb35-27" title="27"></a>
<a class="sourceLine" id="cb35-28" title="28">pReject &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(sampleSize))</a>
<a class="sourceLine" id="cb35-29" title="29"></a>
<a class="sourceLine" id="cb35-30" title="30"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sampleSize)) {</a>
<a class="sourceLine" id="cb35-31" title="31"></a>
<a class="sourceLine" id="cb35-32" title="32"></a>
<a class="sourceLine" id="cb35-33" title="33">  n &lt;-<span class="st"> </span>sampleSize[i]</a>
<a class="sourceLine" id="cb35-34" title="34"></a>
<a class="sourceLine" id="cb35-35" title="35">  b &lt;-<span class="st"> </span><span class="kw">replicate</span>(m,</a>
<a class="sourceLine" id="cb35-36" title="36">                       {</a>
<a class="sourceLine" id="cb35-37" title="37">                         <span class="co">## generate samples</span></a>
<a class="sourceLine" id="cb35-38" title="38">                          x &lt;-<span class="st"> </span><span class="kw">rmvn.eigen</span>(n,mu,Sigma)</a>
<a class="sourceLine" id="cb35-39" title="39">                          <span class="co"># compute sample mean</span></a>
<a class="sourceLine" id="cb35-40" title="40">                          xbar &lt;-<span class="st"> </span><span class="kw">apply</span>(x,<span class="dv">2</span>,mean)</a>
<a class="sourceLine" id="cb35-41" title="41">                          <span class="co"># x Centralization</span></a>
<a class="sourceLine" id="cb35-42" title="42">                          x[,<span class="dv">1</span>] &lt;-<span class="st"> </span>x[,<span class="dv">1</span>]<span class="op">-</span>xbar[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb35-43" title="43">                          x[,<span class="dv">2</span>] &lt;-<span class="st"> </span>x[,<span class="dv">2</span>]<span class="op">-</span>xbar[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb35-44" title="44"></a>
<a class="sourceLine" id="cb35-45" title="45">                          <span class="co"># compute MLE of cor</span></a>
<a class="sourceLine" id="cb35-46" title="46">                          sumOfCox &lt;-<span class="st"> </span><span class="kw">sum</span>(x[,<span class="dv">1</span>]<span class="op">*</span>x[,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb35-47" title="47">                          sumList &lt;-<span class="kw">apply</span>(x,<span class="dv">2</span>,<span class="cf">function</span>(x) <span class="kw">sum</span>(x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb35-48" title="48">                        corHat&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(sumList[<span class="dv">1</span>],sumOfCox,sumOfCox,sumList[<span class="dv">2</span>]),</a>
<a class="sourceLine" id="cb35-49" title="49">                                      <span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">ncol=</span><span class="dv">2</span>)<span class="op">/</span>n</a>
<a class="sourceLine" id="cb35-50" title="50">                          solveMatrix &lt;-<span class="st"> </span><span class="kw">solve</span>(corHat)</a>
<a class="sourceLine" id="cb35-51" title="51"></a>
<a class="sourceLine" id="cb35-52" title="52">                          <span class="co"># compute  b</span></a>
<a class="sourceLine" id="cb35-53" title="53">                          <span class="kw">sum</span>((x <span class="op">%*%</span><span class="st"> </span>solveMatrix <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(x))<span class="op">^</span><span class="dv">3</span>)<span class="op">/</span>n<span class="op">/</span>n</a>
<a class="sourceLine" id="cb35-54" title="54">                       })</a>
<a class="sourceLine" id="cb35-55" title="55">  pReject[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">as.integer</span>(n<span class="op">*</span>b<span class="op">/</span><span class="dv">6</span><span class="op">&gt;</span>r))</a>
<a class="sourceLine" id="cb35-56" title="56"></a>
<a class="sourceLine" id="cb35-57" title="57">}</a>
<a class="sourceLine" id="cb35-58" title="58"></a>
<a class="sourceLine" id="cb35-59" title="59"><span class="co">## 打印不同n对应的拒绝概率</span></a>
<a class="sourceLine" id="cb35-60" title="60"><span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(pReject)) {</a>
<a class="sourceLine" id="cb35-61" title="61"></a>
<a class="sourceLine" id="cb35-62" title="62">  <span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&quot;n=&quot;</span>,sampleSize[index],<span class="st">&quot;reject prob is &quot;</span> ,pReject[index]))</a>
<a class="sourceLine" id="cb35-63" title="63"></a>
<a class="sourceLine" id="cb35-64" title="64">}</a></code></pre></div>
<pre><code>## [1] &quot;n=10reject prob is 0.0042&quot;
## [1] &quot;n=20reject prob is 0.0274&quot;
## [1] &quot;n=30reject prob is 0.0371&quot;
## [1] &quot;n=50reject prob is 0.0459&quot;
## [1] &quot;n=100reject prob is 0.0499&quot;
## [1] &quot;n=500reject prob is 0.046&quot;</code></pre>
<p>取alpha为0.05，由于统计量服从的是渐进分布，当n很大时，经验拒绝概率与alpha比较接近。</p>
</div>
<div id="repeat-example-6.10" class="section level4">
<h4>1.Repeat Example 6.10</h4>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="co">## 维度</span></a>
<a class="sourceLine" id="cb37-2" title="2">d &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb37-3" title="3"></a>
<a class="sourceLine" id="cb37-4" title="4"><span class="co">## 函数：生成多元正态r.v.</span></a>
<a class="sourceLine" id="cb37-5" title="5">rmvn.eigen &lt;-<span class="st"> </span><span class="cf">function</span>(n, mu, Sigma) {</a>
<a class="sourceLine" id="cb37-6" title="6">  dim &lt;-<span class="st"> </span><span class="kw">length</span>(mu)</a>
<a class="sourceLine" id="cb37-7" title="7">  ev &lt;-<span class="st"> </span><span class="kw">eigen</span>(Sigma, <span class="dt">symmetric =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb37-8" title="8">  lamb &lt;-<span class="st"> </span>ev<span class="op">$</span>values</a>
<a class="sourceLine" id="cb37-9" title="9">  V &lt;-<span class="st"> </span>ev<span class="op">$</span>vectors</a>
<a class="sourceLine" id="cb37-10" title="10">  C &lt;-<span class="st"> </span>V <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(<span class="kw">sqrt</span>(lamb)) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(V)</a>
<a class="sourceLine" id="cb37-11" title="11">  Z &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n<span class="op">*</span>dim), <span class="dt">nrow =</span> n, <span class="dt">ncol =</span> d)</a>
<a class="sourceLine" id="cb37-12" title="12">  X &lt;-<span class="st"> </span>Z <span class="op">%*%</span><span class="st"> </span>C <span class="op">+</span><span class="st"> </span><span class="kw">matrix</span>(mu, n, dim, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb37-13" title="13">  <span class="kw">return</span>(X)</a>
<a class="sourceLine" id="cb37-14" title="14">}</a>
<a class="sourceLine" id="cb37-15" title="15"></a>
<a class="sourceLine" id="cb37-16" title="16"><span class="co">## 总体分布</span></a>
<a class="sourceLine" id="cb37-17" title="17">mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb37-18" title="18">Sigma1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.8</span>,<span class="fl">0.8</span>,<span class="dv">2</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">ncol=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb37-19" title="19">Sigma2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">10</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="dv">200</span>), <span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">ncol=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb37-20" title="20"></a>
<a class="sourceLine" id="cb37-21" title="21"><span class="co">## 卡方分布的分位数用于划定拒绝域</span></a>
<a class="sourceLine" id="cb37-22" title="22">r &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="dv">1</span><span class="fl">-0.1</span>,<span class="dt">df=</span>d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</a>
<a class="sourceLine" id="cb37-23" title="23"></a>
<a class="sourceLine" id="cb37-24" title="24"><span class="co">## epsilon，作为横轴</span></a>
<a class="sourceLine" id="cb37-25" title="25">epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="fl">0.15</span>,<span class="fl">0.01</span>), <span class="kw">seq</span>(<span class="fl">0.15</span>,<span class="dv">1</span>,<span class="fl">0.05</span>))</a>
<a class="sourceLine" id="cb37-26" title="26"></a>
<a class="sourceLine" id="cb37-27" title="27"><span class="co">## pwr,功效，作为纵轴</span></a>
<a class="sourceLine" id="cb37-28" title="28">pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(epsilon))</a>
<a class="sourceLine" id="cb37-29" title="29"></a>
<a class="sourceLine" id="cb37-30" title="30"><span class="co">## 每个epsilon，模拟m次</span></a>
<a class="sourceLine" id="cb37-31" title="31">m &lt;-<span class="st"> </span><span class="dv">2500</span></a>
<a class="sourceLine" id="cb37-32" title="32"></a>
<a class="sourceLine" id="cb37-33" title="33"><span class="co">## samle size</span></a>
<a class="sourceLine" id="cb37-34" title="34">n &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb37-35" title="35"></a>
<a class="sourceLine" id="cb37-36" title="36"><span class="co">## main loop</span></a>
<a class="sourceLine" id="cb37-37" title="37"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(epsilon)) {</a>
<a class="sourceLine" id="cb37-38" title="38"></a>
<a class="sourceLine" id="cb37-39" title="39">  <span class="co"># e</span></a>
<a class="sourceLine" id="cb37-40" title="40">  e &lt;-<span class="st"> </span>epsilon[i]</a>
<a class="sourceLine" id="cb37-41" title="41"></a>
<a class="sourceLine" id="cb37-42" title="42"></a>
<a class="sourceLine" id="cb37-43" title="43">  <span class="co"># simulate</span></a>
<a class="sourceLine" id="cb37-44" title="44">  b &lt;-<span class="st"> </span><span class="kw">replicate</span>(m,</a>
<a class="sourceLine" id="cb37-45" title="45">            {</a>
<a class="sourceLine" id="cb37-46" title="46">              <span class="co"># generate samples</span></a>
<a class="sourceLine" id="cb37-47" title="47">              sampleIndex &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">replace=</span>T,<span class="dt">size=</span>n,<span class="dt">prob=</span><span class="kw">c</span>(e,<span class="dv">1</span><span class="op">-</span>e)))</a>
<a class="sourceLine" id="cb37-48" title="48"></a>
<a class="sourceLine" id="cb37-49" title="49">              <span class="cf">if</span> (sampleIndex <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) {</a>
<a class="sourceLine" id="cb37-50" title="50">                x &lt;-<span class="st"> </span><span class="kw">rmvn.eigen</span>(n,mu,Sigma2)</a>
<a class="sourceLine" id="cb37-51" title="51">              } <span class="cf">else</span> <span class="cf">if</span> (sampleIndex <span class="op">==</span><span class="st"> </span>n) {</a>
<a class="sourceLine" id="cb37-52" title="52">                x &lt;-<span class="st"> </span><span class="kw">rmvn.eigen</span>(n,mu,Sigma1)</a>
<a class="sourceLine" id="cb37-53" title="53">              } <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb37-54" title="54">                samplesWithCorSigma1 &lt;-<span class="st"> </span><span class="kw">rmvn.eigen</span>(sampleIndex,mu,Sigma1)</a>
<a class="sourceLine" id="cb37-55" title="55">                samplesWithCorSigma2 &lt;-<span class="st"> </span><span class="kw">rmvn.eigen</span>(n<span class="op">-</span>sampleIndex,mu,Sigma2)</a>
<a class="sourceLine" id="cb37-56" title="56">                x &lt;-<span class="st"> </span><span class="kw">rbind</span>(samplesWithCorSigma1,samplesWithCorSigma2)</a>
<a class="sourceLine" id="cb37-57" title="57">              }</a>
<a class="sourceLine" id="cb37-58" title="58"></a>
<a class="sourceLine" id="cb37-59" title="59">              <span class="co"># compute sample mean</span></a>
<a class="sourceLine" id="cb37-60" title="60">              xbar &lt;-<span class="st"> </span><span class="kw">apply</span>(x,<span class="dv">2</span>,mean)</a>
<a class="sourceLine" id="cb37-61" title="61"></a>
<a class="sourceLine" id="cb37-62" title="62">              <span class="co"># x Centralization</span></a>
<a class="sourceLine" id="cb37-63" title="63">              x[,<span class="dv">1</span>] &lt;-<span class="st"> </span>x[,<span class="dv">1</span>]<span class="op">-</span>xbar[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb37-64" title="64">              x[,<span class="dv">2</span>] &lt;-<span class="st"> </span>x[,<span class="dv">2</span>]<span class="op">-</span>xbar[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb37-65" title="65"></a>
<a class="sourceLine" id="cb37-66" title="66">              <span class="co"># compute MLE of cor</span></a>
<a class="sourceLine" id="cb37-67" title="67">              sumOfCox &lt;-<span class="st"> </span><span class="kw">sum</span>(x[,<span class="dv">1</span>]<span class="op">*</span>x[,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb37-68" title="68">              sumList &lt;-<span class="kw">apply</span>(x,<span class="dv">2</span>,<span class="cf">function</span>(x) <span class="kw">sum</span>(x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb37-69" title="69">              corHat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(sumList[<span class="dv">1</span>],sumOfCox,sumOfCox,sumList[<span class="dv">2</span>]),<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">ncol=</span><span class="dv">2</span>)<span class="op">/</span>n</a>
<a class="sourceLine" id="cb37-70" title="70">              solveMatrix &lt;-<span class="st"> </span><span class="kw">solve</span>(corHat)</a>
<a class="sourceLine" id="cb37-71" title="71"></a>
<a class="sourceLine" id="cb37-72" title="72">              <span class="co"># compute  b</span></a>
<a class="sourceLine" id="cb37-73" title="73">              <span class="kw">sum</span>((x <span class="op">%*%</span><span class="st"> </span>solveMatrix <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(x))<span class="op">^</span><span class="dv">3</span>)<span class="op">/</span>n<span class="op">/</span>n}</a>
<a class="sourceLine" id="cb37-74" title="74">            )</a>
<a class="sourceLine" id="cb37-75" title="75"></a>
<a class="sourceLine" id="cb37-76" title="76">  pwr[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">as.integer</span>(n<span class="op">*</span>b<span class="op">/</span><span class="dv">6</span><span class="op">&gt;</span>r))</a>
<a class="sourceLine" id="cb37-77" title="77">}</a>
<a class="sourceLine" id="cb37-78" title="78"></a>
<a class="sourceLine" id="cb37-79" title="79"></a>
<a class="sourceLine" id="cb37-80" title="80"><span class="co"># plot</span></a>
<a class="sourceLine" id="cb37-81" title="81"><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type=</span><span class="st">&quot;b&quot;</span>,<span class="dt">xlab=</span><span class="kw">bquote</span>(epsilon))</a>
<a class="sourceLine" id="cb37-82" title="82"><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">0.1</span>, <span class="dt">lty=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</a>
<a class="sourceLine" id="cb37-83" title="83"></a>
<a class="sourceLine" id="cb37-84" title="84">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pwr)<span class="op">/</span><span class="st"> </span>m)</a>
<a class="sourceLine" id="cb37-85" title="85"></a>
<a class="sourceLine" id="cb37-86" title="86"><span class="kw">lines</span>(epsilon, pwr<span class="op">+</span>se,<span class="dt">lty=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb37-87" title="87"><span class="kw">lines</span>(epsilon, pwr<span class="op">-</span>se,<span class="dt">lty=</span><span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>本题取alpha=0.1，当epsilon为0和1时，总体分布为多元正态分布，所以功效与alpha较为接近</p>
</div>
</div>
</div>
<div id="discussion-homework" class="section level2">
<h2>Discussion (homework)</h2>
<ol style="list-style-type: decimal">
<li><p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p></li>
<li><p>What is the corresponding hypothesis test problem?</p></li>
<li><p>What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?</p></li>
<li><p>What information is needed to test your hypothesis?</p></li>
</ol>
<div id="answer-11" class="section level3">
<h3>Answer</h3>
<p>1.记两种方法的功效分别为<span class="math inline">\(p_1,p_2\)</span>，则检验假设为： <span class="math display">\[H_0:p_1=p_2 \quad \text{vs} \quad H_1:p_1 \not= p_2\]</span></p>
<p>2.注意：10,000 experiments: 0.651 for one method and 0.676 for another method.也就是说分别做10000次实验，方法一样本落在拒绝域<span class="math inline">\(X=6510\)</span>次，方法二样本落在拒绝域<span class="math inline">\(Y=6760\)</span>次。其中<span class="math inline">\(X \sim B(n,p_1),\quad Y \sim B(n,p_2)\)</span>.当试验次数n很大时,X和Y趋向于正态分布，极限均值为<span class="math inline">\(EX=np_1，EY=np_2\)</span>，</p>
<p>3.但是不可以采用two-sample t-test！这是因为X与Y并不独立，事实上当X取较大值时，说明在该参数点拒绝<span class="math inline">\(H_0\)</span>的概率较大，那么Y也倾向于取较大值。而其他三种检验方法并不要求X与Y独立，都可以采用.</p>
<p>4.还需要的额外信息：10000次实验过程中，每次是接受还是拒绝需要记录下来</p>
</div>
</div>
</div>
<div id="第六次作业" class="section level1">
<h1>第六次作业</h1>
<div id="section-4" class="section level2">
<h2>7.1</h2>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
<div id="answer-12" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="co"># import</span></a>
<a class="sourceLine" id="cb38-2" title="2"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb38-3" title="3"></a>
<a class="sourceLine" id="cb38-4" title="4"><span class="co"># Original</span></a>
<a class="sourceLine" id="cb38-5" title="5">thetaHat &lt;-<span class="st"> </span><span class="kw">cor</span>(law<span class="op">$</span>LSAT ,law<span class="op">$</span>GPA)</a>
<a class="sourceLine" id="cb38-6" title="6"></a>
<a class="sourceLine" id="cb38-7" title="7">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(law)</a>
<a class="sourceLine" id="cb38-8" title="8">theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb38-9" title="9"></a>
<a class="sourceLine" id="cb38-10" title="10"><span class="co"># Jackknife</span></a>
<a class="sourceLine" id="cb38-11" title="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb38-12" title="12">  law.jack &lt;-<span class="st"> </span>law[<span class="op">-</span>i,]</a>
<a class="sourceLine" id="cb38-13" title="13">  theta.jack[i] &lt;-<span class="st"> </span><span class="kw">cor</span>(law.jack<span class="op">$</span>LSAT, law.jack<span class="op">$</span>GPA)</a>
<a class="sourceLine" id="cb38-14" title="14">}</a>
<a class="sourceLine" id="cb38-15" title="15"></a>
<a class="sourceLine" id="cb38-16" title="16"><span class="co"># bias and se of Jack estimate</span></a>
<a class="sourceLine" id="cb38-17" title="17">biasOfJack &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>(theta.jack<span class="op">-</span>thetaHat)</a>
<a class="sourceLine" id="cb38-18" title="18">seOfJack &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="st"> </span><span class="kw">mean</span>((theta.jack<span class="op">-</span><span class="kw">mean</span>(theta.jack))<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb38-19" title="19"></a>
<a class="sourceLine" id="cb38-20" title="20"><span class="co"># print</span></a>
<a class="sourceLine" id="cb38-21" title="21"><span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&quot;bias:&quot;</span>,biasOfJack,<span class="st">&quot;   &quot;</span>,<span class="st">&quot;se:&quot;</span>,seOfJack))</a></code></pre></div>
<pre><code>## [1] &quot;bias:-0.0064736230459206   se:0.142518618602272&quot;</code></pre>
</div>
</div>
<div id="section-5" class="section level2">
<h2>7.5</h2>
<p>Refer to Exercise 7.4.Compute 95% bootstrap confidence intervals for the mean time between failures 1/<span class="math inline">\(\lambda\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb40-2" title="2"></a>
<a class="sourceLine" id="cb40-3" title="3">stat &lt;-<span class="st"> </span><span class="cf">function</span>(x, i) {</a>
<a class="sourceLine" id="cb40-4" title="4">  <span class="kw">mean</span>(x[i,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb40-5" title="5">}</a>
<a class="sourceLine" id="cb40-6" title="6"></a>
<a class="sourceLine" id="cb40-7" title="7">obj &lt;-<span class="st"> </span><span class="kw">boot</span>(aircondit,<span class="dt">statistic =</span> stat,<span class="dt">R=</span><span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb40-8" title="8"></a>
<a class="sourceLine" id="cb40-9" title="9"></a>
<a class="sourceLine" id="cb40-10" title="10"><span class="kw">boot.ci</span>(obj, <span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</a></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = obj, type = c(&quot;basic&quot;, &quot;norm&quot;, &quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 34.8, 181.9 )   ( 25.3, 168.8 )  
## 
## Level     Percentile            BCa          
## 95%   ( 47.3, 190.8 )   ( 55.3, 223.7 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<p>各个置信区间不同的原因在于他们的构造方式不同：</p>
<ul>
<li>The basic bootstrap CI based on the large sample property:<span class="math inline">\(\hat{\theta ^*}-\hat \theta |\text{data}\)</span> and <span class="math inline">\(\hat \theta -\theta\)</span> approximately have the same distribution.</li>
<li>Percentile CI (percent) by assuming <span class="math inline">\(\hat{\theta ^*}|\text{data}\)</span> and <span class="math inline">\(\hat \theta\)</span> have approximately the same distribution (estimation bias ignored).</li>
<li>The normal bootstrap CI based on asymptotic normality.</li>
<li>The BCa bootstrap CI is a correction of the percentile CI.</li>
</ul>
</div>
<div id="section-6" class="section level2">
<h2>7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat\theta\)</span>.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb42-2" title="2"></a>
<a class="sourceLine" id="cb42-3" title="3">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)</a>
<a class="sourceLine" id="cb42-4" title="4"></a>
<a class="sourceLine" id="cb42-5" title="5"><span class="co"># 定义求给定矩阵theta值的函数</span></a>
<a class="sourceLine" id="cb42-6" title="6">theta &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb42-7" title="7">  eigenVal &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(x))<span class="op">$</span>values</a>
<a class="sourceLine" id="cb42-8" title="8">  eigenVal[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(eigenVal)</a>
<a class="sourceLine" id="cb42-9" title="9">}</a>
<a class="sourceLine" id="cb42-10" title="10"></a>
<a class="sourceLine" id="cb42-11" title="11"><span class="co"># 计算thetaHat</span></a>
<a class="sourceLine" id="cb42-12" title="12">thetaHat &lt;-<span class="st"> </span><span class="kw">theta</span>(scor)</a>
<a class="sourceLine" id="cb42-13" title="13"></a>
<a class="sourceLine" id="cb42-14" title="14"><span class="co"># jackknife方法</span></a>
<a class="sourceLine" id="cb42-15" title="15">thetaJack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb42-16" title="16"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb42-17" title="17">  thetaJack[i] &lt;-<span class="st"> </span><span class="kw">theta</span>(scor[<span class="op">-</span>i,])</a>
<a class="sourceLine" id="cb42-18" title="18">}</a>
<a class="sourceLine" id="cb42-19" title="19"></a>
<a class="sourceLine" id="cb42-20" title="20"><span class="co"># 计算估计量的偏差和标准差</span></a>
<a class="sourceLine" id="cb42-21" title="21">biasOfJack &lt;-<span class="st"> </span>(n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(thetaJack)<span class="op">-</span>thetaHat)</a>
<a class="sourceLine" id="cb42-22" title="22">seOfJack &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>((thetaJack<span class="op">-</span><span class="kw">mean</span>(thetaJack))<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb42-23" title="23"></a>
<a class="sourceLine" id="cb42-24" title="24"><span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&quot;bias is &quot;</span>,biasOfJack,<span class="st">&quot;, std is &quot;</span>,seOfJack))</a></code></pre></div>
<pre><code>## [1] &quot;bias is 0.00106913888654214, std is 0.0495523072701254&quot;</code></pre>
</div>
<div id="section-7" class="section level2">
<h2>7.11</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="kw">library</span>(DAAG)</a></code></pre></div>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="kw">attach</span>(ironslag)</a>
<a class="sourceLine" id="cb48-2" title="2"></a>
<a class="sourceLine" id="cb48-3" title="3">n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic)</a>
<a class="sourceLine" id="cb48-4" title="4"></a>
<a class="sourceLine" id="cb48-5" title="5">index =<span class="dv">1</span><span class="op">:</span>n</a>
<a class="sourceLine" id="cb48-6" title="6"></a>
<a class="sourceLine" id="cb48-7" title="7">e1 &lt;-e2&lt;-e3&lt;-e4&lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb48-8" title="8"></a>
<a class="sourceLine" id="cb48-9" title="9"><span class="co"># n为奇书，则将index随机分成[n/2]+1组，其中[n/2]组各有2个元素，1个组有1个元素</span></a>
<a class="sourceLine" id="cb48-10" title="10"><span class="cf">while</span> (<span class="kw">length</span>(index) <span class="op">&gt;=</span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb48-11" title="11"></a>
<a class="sourceLine" id="cb48-12" title="12">  <span class="co"># sampling the test set.</span></a>
<a class="sourceLine" id="cb48-13" title="13">  <span class="cf">if</span> (<span class="kw">length</span>(index)<span class="op">==</span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb48-14" title="14">    leaveOut &lt;-<span class="st"> </span>index</a>
<a class="sourceLine" id="cb48-15" title="15">  }</a>
<a class="sourceLine" id="cb48-16" title="16">  <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb48-17" title="17">  leaveOut &lt;-<span class="st"> </span><span class="kw">sample</span>(index,<span class="dt">size=</span><span class="dv">2</span>,<span class="dt">replace =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb48-18" title="18">  }</a>
<a class="sourceLine" id="cb48-19" title="19"></a>
<a class="sourceLine" id="cb48-20" title="20">  <span class="co"># tranning set</span></a>
<a class="sourceLine" id="cb48-21" title="21">  x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>leaveOut]</a>
<a class="sourceLine" id="cb48-22" title="22">  y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>leaveOut]</a>
<a class="sourceLine" id="cb48-23" title="23"></a>
<a class="sourceLine" id="cb48-24" title="24"></a>
<a class="sourceLine" id="cb48-25" title="25">  J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb48-26" title="26">  yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[leaveOut]</a>
<a class="sourceLine" id="cb48-27" title="27">  e1&lt;-<span class="st"> </span><span class="kw">append</span>(e1,magnetic[leaveOut] <span class="op">-</span><span class="st"> </span>yhat1)</a>
<a class="sourceLine" id="cb48-28" title="28"></a>
<a class="sourceLine" id="cb48-29" title="29">  J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb48-30" title="30">  yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J2<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[leaveOut]<span class="op">+</span>J2<span class="op">$</span>coef[<span class="dv">3</span>]<span class="op">*</span>chemical[leaveOut]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb48-31" title="31">  e2&lt;-<span class="st"> </span><span class="kw">append</span>(e2,magnetic[leaveOut] <span class="op">-</span><span class="st"> </span>yhat2)</a>
<a class="sourceLine" id="cb48-32" title="32"></a>
<a class="sourceLine" id="cb48-33" title="33">  J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb48-34" title="34">  logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[leaveOut]</a>
<a class="sourceLine" id="cb48-35" title="35">  yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</a>
<a class="sourceLine" id="cb48-36" title="36">  e3 &lt;-<span class="kw">append</span>(e3,magnetic[leaveOut] <span class="op">-</span><span class="st"> </span>yhat3)</a>
<a class="sourceLine" id="cb48-37" title="37"></a>
<a class="sourceLine" id="cb48-38" title="38">  J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))</a>
<a class="sourceLine" id="cb48-39" title="39">  logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[leaveOut])</a>
<a class="sourceLine" id="cb48-40" title="40">  yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4)</a>
<a class="sourceLine" id="cb48-41" title="41">  e4 &lt;-<span class="kw">append</span>(e4,magnetic[leaveOut] <span class="op">-</span><span class="st"> </span>yhat4)</a>
<a class="sourceLine" id="cb48-42" title="42"></a>
<a class="sourceLine" id="cb48-43" title="43">  index &lt;-<span class="st"> </span>index[<span class="op">!</span>(index <span class="op">%in%</span><span class="st"> </span>leaveOut)]</a>
<a class="sourceLine" id="cb48-44" title="44"></a>
<a class="sourceLine" id="cb48-45" title="45">}</a>
<a class="sourceLine" id="cb48-46" title="46"></a>
<a class="sourceLine" id="cb48-47" title="47"></a>
<a class="sourceLine" id="cb48-48" title="48"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>),<span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>),<span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>),<span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>)))</a></code></pre></div>
<pre><code>## [1] 19.42810 17.62190 18.24592 20.33245</code></pre>
<p>According to the prediction error criterion, Model 2, the quadratic model, would be the best fit for the data.</p>
</div>
</div>
<div id="第七次作业" class="section level1">
<h1>第七次作业</h1>
<div id="exercise-8.3" class="section level2">
<h2>Exercise 8.3</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="solution" class="section level2">
<h2>Solution</h2>
<div id="分析" class="section level3">
<h3>1.分析</h3>
<ul>
<li>对样本容量不同的两组样本<span class="math inline">\(X=(x_1,x_2,\dots,x_n),Y=(y_1,y_2,\dots,y_m)\)</span>,不妨设n &lt;m,令<span class="math inline">\(Z=(x_1,x_2,\dots,x_n,y_1,y_2,\dots,y_m)\)</span></li>
<li>将Z截断为两截<span class="math inline">\(Z=(Z_1,Z_2)\)</span>，每段长度均为<span class="math inline">\(\frac{m+n}{2}\)</span>,这样就满足CountFive中“样本容量大小相同”的要求了.具体截取方法是：从样本容量较大的Y样本中随机选取<span class="math inline">\(\frac{m-n}{2}\)</span>个数据放入X中</li>
<li>如果原假设成立,<span class="math inline">\(Z_1,Z_2\)</span>的方差相等,mean(maxout&gt;=5)应该很小.</li>
</ul>
</div>
<div id="模拟" class="section level3">
<h3>2.模拟</h3>
<p>对于容量均为20，且均值、方差相等的两组样本，记maxout为第六章所述的统计量，m次模拟中（用样本均值去中心化），maxout大于5的比例大概在0.055（见课本第178页）.下述的模拟也是在验证这一点</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="co"># function: return the number of extreme data</span></a>
<a class="sourceLine" id="cb50-2" title="2">MaxOutNum &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb50-3" title="3">  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb50-4" title="4">  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb50-5" title="5">  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</a>
<a class="sourceLine" id="cb50-6" title="6">  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb50-7" title="7">  <span class="kw">return</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)))</a>
<a class="sourceLine" id="cb50-8" title="8">}</a>
<a class="sourceLine" id="cb50-9" title="9"></a>
<a class="sourceLine" id="cb50-10" title="10"></a>
<a class="sourceLine" id="cb50-11" title="11">m&lt;-<span class="st"> </span><span class="dv">100000</span></a>
<a class="sourceLine" id="cb50-12" title="12"></a>
<a class="sourceLine" id="cb50-13" title="13"><span class="co"># 两组样本，容量均为20，且方差相等，countfive方法检验</span></a>
<a class="sourceLine" id="cb50-14" title="14">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb50-15" title="15"></a>
<a class="sourceLine" id="cb50-16" title="16">x1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb50-17" title="17">x2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb50-18" title="18">tests &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr =</span> {</a>
<a class="sourceLine" id="cb50-19" title="19">    x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb50-20" title="20">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb50-21" title="21">    <span class="kw">MaxOutNum</span>(x, y)</a>
<a class="sourceLine" id="cb50-22" title="22">})</a>
<a class="sourceLine" id="cb50-23" title="23"></a>
<a class="sourceLine" id="cb50-24" title="24">RateOfMaxOutExceed5 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">cumsum</span>(<span class="kw">table</span>(tests))[<span class="dv">5</span>]<span class="op">/</span>m</a>
<a class="sourceLine" id="cb50-25" title="25"><span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&quot;The rate that maxout exceed 5 is &quot;</span>,RateOfMaxOutExceed5))</a></code></pre></div>
<pre><code>## [1] &quot;The rate that maxout exceed 5 is 0.05516&quot;</code></pre>
<p>回到本题，对样本量不相同的两个样本</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="co"># function：return 1 if the number of extreme data &gt;=5</span></a>
<a class="sourceLine" id="cb52-2" title="2">MaxOut &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb52-3" title="3">  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb52-4" title="4">  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb52-5" title="5">  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</a>
<a class="sourceLine" id="cb52-6" title="6">  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb52-7" title="7">  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy))<span class="op">&gt;</span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb52-8" title="8">}</a>
<a class="sourceLine" id="cb52-9" title="9"></a>
<a class="sourceLine" id="cb52-10" title="10"></a>
<a class="sourceLine" id="cb52-11" title="11"><span class="co"># sample size</span></a>
<a class="sourceLine" id="cb52-12" title="12">n1 &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb52-13" title="13">n2 &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb52-14" title="14">k &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>((n1<span class="op">+</span>n2)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb52-15" title="15"></a>
<a class="sourceLine" id="cb52-16" title="16"><span class="co"># replicate</span></a>
<a class="sourceLine" id="cb52-17" title="17">m&lt;-<span class="st"> </span><span class="dv">100000</span></a>
<a class="sourceLine" id="cb52-18" title="18"></a>
<a class="sourceLine" id="cb52-19" title="19">rep &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb52-20" title="20"></a>
<a class="sourceLine" id="cb52-21" title="21"><span class="co"># function: return rate of maxout which exceed 5.</span></a>
<a class="sourceLine" id="cb52-22" title="22">tests &lt;-<span class="st"> </span><span class="cf">function</span>(sd1, sd2){</a>
<a class="sourceLine" id="cb52-23" title="23">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb52-24" title="24">    x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span>sd1)</a>
<a class="sourceLine" id="cb52-25" title="25">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span>sd2)</a>
<a class="sourceLine" id="cb52-26" title="26"></a>
<a class="sourceLine" id="cb52-27" title="27">    <span class="co"># equal sample size</span></a>
<a class="sourceLine" id="cb52-28" title="28">    <span class="co"># select 10 data from y and add them to x.</span></a>
<a class="sourceLine" id="cb52-29" title="29">    y_to_x &lt;-<span class="st"> </span><span class="kw">sample</span>(y,<span class="dt">size =</span> <span class="dv">10</span>,<span class="dt">replace =</span> F)</a>
<a class="sourceLine" id="cb52-30" title="30">    x &lt;-<span class="st"> </span><span class="kw">c</span>(x,y_to_x)</a>
<a class="sourceLine" id="cb52-31" title="31">    y &lt;-<span class="st"> </span><span class="kw">setdiff</span>(y,y_to_x)</a>
<a class="sourceLine" id="cb52-32" title="32"></a>
<a class="sourceLine" id="cb52-33" title="33">    <span class="co"># maxout</span></a>
<a class="sourceLine" id="cb52-34" title="34">    rep[i] &lt;-<span class="st"> </span><span class="kw">MaxOut</span>(x,y)</a>
<a class="sourceLine" id="cb52-35" title="35">}</a>
<a class="sourceLine" id="cb52-36" title="36"><span class="kw">mean</span>(rep)</a>
<a class="sourceLine" id="cb52-37" title="37">}</a>
<a class="sourceLine" id="cb52-38" title="38"></a>
<a class="sourceLine" id="cb52-39" title="39"></a>
<a class="sourceLine" id="cb52-40" title="40"><span class="kw">tests</span>(<span class="dt">sd1=</span><span class="dv">1</span>, <span class="dt">sd2=</span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1] 0.05548</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="kw">tests</span>(<span class="dt">sd1=</span><span class="dv">1</span>,<span class="dt">sd2=</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 0.13415</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="kw">tests</span>(<span class="dt">sd1=</span><span class="dv">1</span>,<span class="dt">sd2=</span><span class="dv">10</span>)</a></code></pre></div>
<pre><code>## [1] 0.17186</code></pre>
<p>可见该检验是显著的。</p>
<ul>
<li>当两组样本方差相同时，返回值为0.055附近，与理论值吻合</li>
<li>当两组样本方差不相同时，返回值与0.055偏差较大</li>
</ul>
</div>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<ul>
<li><p>Unequal variances and equal expectations</p></li>
<li><p>Unequal variances and unequal expectations</p></li>
<li><p>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p></li>
<li><p>Unbalanced samples (say, 1 case versus 10 controls)</p></li>
<li><p>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p></li>
</ul>
</div>
<div id="solution-1" class="section level2">
<h2>Solution</h2>
<div id="函数和一些参数" class="section level3">
<h3>函数和一些参数</h3>
<p>首先定义函数，并指定一些参数</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="kw">library</span>(RANN)</a>
<a class="sourceLine" id="cb58-2" title="2"><span class="kw">library</span>(energy)</a>
<a class="sourceLine" id="cb58-3" title="3"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb58-4" title="4"><span class="kw">library</span>(Ball)</a>
<a class="sourceLine" id="cb58-5" title="5"><span class="kw">library</span>(mvtnorm)</a>
<a class="sourceLine" id="cb58-6" title="6"><span class="kw">library</span>(MASS)</a></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:DAAG&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1">Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</a>
<a class="sourceLine" id="cb61-2" title="2">  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</a>
<a class="sourceLine" id="cb61-3" title="3">  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</a>
<a class="sourceLine" id="cb61-4" title="4">  z &lt;-<span class="st"> </span>z[ix, ];</a>
<a class="sourceLine" id="cb61-5" title="5">  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb61-6" title="6">  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb61-7" title="7">  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb61-8" title="8">  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</a>
<a class="sourceLine" id="cb61-9" title="9">  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</a>
<a class="sourceLine" id="cb61-10" title="10">}</a>
<a class="sourceLine" id="cb61-11" title="11"></a>
<a class="sourceLine" id="cb61-12" title="12"></a>
<a class="sourceLine" id="cb61-13" title="13"></a>
<a class="sourceLine" id="cb61-14" title="14">m &lt;-<span class="st"> </span><span class="fl">1e3</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; mu &lt;-<span class="st"> </span><span class="fl">0.5</span>; <span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb61-15" title="15">n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</a>
<a class="sourceLine" id="cb61-16" title="16">eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</a>
<a class="sourceLine" id="cb61-17" title="17">  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</a>
<a class="sourceLine" id="cb61-18" title="18">                   <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</a>
<a class="sourceLine" id="cb61-19" title="19">  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb61-20" title="20">  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb61-21" title="21">  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</a>
<a class="sourceLine" id="cb61-22" title="22">}</a></code></pre></div>
</div>
<div id="unequal-variances-and-equal-expectations" class="section level3">
<h3>1.Unequal variances and equal expectations</h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1">mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb62-2" title="2">Sigma1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb62-3" title="3">Sigma2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>),<span class="dt">nrow=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb62-4" title="4"></a>
<a class="sourceLine" id="cb62-5" title="5"></a>
<a class="sourceLine" id="cb62-6" title="6"></a>
<a class="sourceLine" id="cb62-7" title="7">p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb62-8" title="8"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb62-9" title="9">  x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n1,mu1,Sigma1)</a>
<a class="sourceLine" id="cb62-10" title="10">  y &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n2,mu2,Sigma2)</a>
<a class="sourceLine" id="cb62-11" title="11">  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</a>
<a class="sourceLine" id="cb62-12" title="12">  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb62-13" title="13">  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb62-14" title="14">  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.va</a>
<a class="sourceLine" id="cb62-15" title="15">}</a>
<a class="sourceLine" id="cb62-16" title="16"></a>
<a class="sourceLine" id="cb62-17" title="17"></a>
<a class="sourceLine" id="cb62-18" title="18">alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></a>
<a class="sourceLine" id="cb62-19" title="19">pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb62-20" title="20"><span class="kw">print</span>(pow)</a></code></pre></div>
<pre><code>## [1] 0.467 0.536 0.785</code></pre>
<p>在此条件下，Ball优于energy，优于NN</p>
</div>
<div id="unequal-variances-and-unequal-expectations" class="section level3">
<h3>2.Unequal variances and unequal expectations</h3>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1">mu1 &lt;-<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) ;mu2 &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb64-2" title="2">Sigma1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb64-3" title="3">Sigma2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>),<span class="dt">nrow=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb64-4" title="4"></a>
<a class="sourceLine" id="cb64-5" title="5"></a>
<a class="sourceLine" id="cb64-6" title="6"></a>
<a class="sourceLine" id="cb64-7" title="7">p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb64-8" title="8"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb64-9" title="9">  x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n1,mu1,Sigma1)</a>
<a class="sourceLine" id="cb64-10" title="10">  y &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n2,mu2,Sigma2)</a>
<a class="sourceLine" id="cb64-11" title="11">  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</a>
<a class="sourceLine" id="cb64-12" title="12">  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb64-13" title="13">  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb64-14" title="14">  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.va</a>
<a class="sourceLine" id="cb64-15" title="15">}</a>
<a class="sourceLine" id="cb64-16" title="16"></a>
<a class="sourceLine" id="cb64-17" title="17"></a>
<a class="sourceLine" id="cb64-18" title="18">alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></a>
<a class="sourceLine" id="cb64-19" title="19">pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb64-20" title="20"><span class="kw">print</span>(pow)</a></code></pre></div>
<pre><code>## [1] 0.660 0.889 0.913</code></pre>
<p>在此条件下，Ball优于energy，优于NN</p>
</div>
<div id="t-vs-mixture" class="section level3">
<h3>3.t vs mixture</h3>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1">mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb66-2" title="2">Sigma1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb66-3" title="3">Sigma2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>),<span class="dt">nrow=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb66-4" title="4"></a>
<a class="sourceLine" id="cb66-5" title="5"></a>
<a class="sourceLine" id="cb66-6" title="6"><span class="co"># Function:Generate the mixture distribution of two  normal distribution</span></a>
<a class="sourceLine" id="cb66-7" title="7">bimvrnorm &lt;-<span class="st"> </span><span class="cf">function</span> (n,e,mu1,mu2,Sigma1,Sigma2) {</a>
<a class="sourceLine" id="cb66-8" title="8">  sampleIndex &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">replace=</span>T,<span class="dt">size=</span>n,<span class="dt">prob=</span><span class="kw">c</span>(e,<span class="dv">1</span><span class="op">-</span>e)))</a>
<a class="sourceLine" id="cb66-9" title="9"></a>
<a class="sourceLine" id="cb66-10" title="10">  <span class="cf">if</span> (sampleIndex <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) {</a>
<a class="sourceLine" id="cb66-11" title="11">    x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n,mu2,Sigma2)</a>
<a class="sourceLine" id="cb66-12" title="12">  } <span class="cf">else</span> <span class="cf">if</span> (sampleIndex <span class="op">==</span><span class="st"> </span>n) {</a>
<a class="sourceLine" id="cb66-13" title="13">    x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n,mu1,Sigma1)</a>
<a class="sourceLine" id="cb66-14" title="14">  } <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb66-15" title="15">    samplesWithCorSigma1 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(sampleIndex,mu1,Sigma1)</a>
<a class="sourceLine" id="cb66-16" title="16">    samplesWithCorSigma2 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n<span class="op">-</span>sampleIndex,mu2,Sigma2)</a>
<a class="sourceLine" id="cb66-17" title="17">    x &lt;-<span class="st"> </span><span class="kw">rbind</span>(samplesWithCorSigma1,samplesWithCorSigma2)</a>
<a class="sourceLine" id="cb66-18" title="18">  }</a>
<a class="sourceLine" id="cb66-19" title="19"></a>
<a class="sourceLine" id="cb66-20" title="20">  <span class="kw">return</span>(x)</a>
<a class="sourceLine" id="cb66-21" title="21">}</a>
<a class="sourceLine" id="cb66-22" title="22"></a>
<a class="sourceLine" id="cb66-23" title="23"></a>
<a class="sourceLine" id="cb66-24" title="24">p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb66-25" title="25"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb66-26" title="26">  x&lt;-<span class="st"> </span><span class="kw">rmvt</span>(n1, <span class="dt">sigma =</span> <span class="kw">diag</span>(<span class="dv">2</span>), <span class="dt">df =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb66-27" title="27">  y &lt;-<span class="st"> </span><span class="kw">bimvrnorm</span>(n2,<span class="fl">0.4</span>,mu1,mu2,Sigma1,Sigma2)</a>
<a class="sourceLine" id="cb66-28" title="28">  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</a>
<a class="sourceLine" id="cb66-29" title="29">  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb66-30" title="30">  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb66-31" title="31">  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.va</a>
<a class="sourceLine" id="cb66-32" title="32">}</a>
<a class="sourceLine" id="cb66-33" title="33"></a>
<a class="sourceLine" id="cb66-34" title="34">alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></a>
<a class="sourceLine" id="cb66-35" title="35">pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb66-36" title="36"><span class="kw">print</span>(pow)</a></code></pre></div>
<pre><code>## [1] 0.514 0.921 0.892</code></pre>
<p>在此条件下，energy优于Ball，优于NN</p>
</div>
<div id="t-distribution" class="section level3">
<h3>4. t distribution</h3>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1">p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb68-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb68-3" title="3">  x&lt;-<span class="st"> </span><span class="kw">rmvt</span>(n1, <span class="dt">sigma =</span> <span class="kw">diag</span>(<span class="dv">2</span>), <span class="dt">df =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb68-4" title="4">  y&lt;-<span class="st"> </span><span class="kw">rmvt</span>(n2, <span class="dt">sigma =</span> <span class="kw">diag</span>(<span class="dv">2</span>), <span class="dt">df =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb68-5" title="5">  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</a>
<a class="sourceLine" id="cb68-6" title="6">  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb68-7" title="7">  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb68-8" title="8">  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.va</a>
<a class="sourceLine" id="cb68-9" title="9">}</a>
<a class="sourceLine" id="cb68-10" title="10"></a>
<a class="sourceLine" id="cb68-11" title="11">alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></a>
<a class="sourceLine" id="cb68-12" title="12">pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb68-13" title="13"><span class="kw">print</span>(pow)</a></code></pre></div>
<pre><code>## [1] 0.265 0.726 0.661</code></pre>
<p>在此条件下，energy优于Ball，优于NN</p>
</div>
<div id="bimodel-distribution" class="section level3">
<h3>5.bimodel distribution</h3>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1">mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb70-2" title="2">mu3 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb70-3" title="3">Sigma1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb70-4" title="4">Sigma2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>),<span class="dt">nrow=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb70-5" title="5"></a>
<a class="sourceLine" id="cb70-6" title="6"></a>
<a class="sourceLine" id="cb70-7" title="7">p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb70-8" title="8"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb70-9" title="9">  x &lt;-<span class="st"> </span><span class="kw">bimvrnorm</span>(n1,<span class="fl">0.4</span>,mu1,mu2,Sigma1,Sigma2)</a>
<a class="sourceLine" id="cb70-10" title="10">  y &lt;-<span class="st"> </span><span class="kw">bimvrnorm</span>(n2,<span class="fl">0.4</span>,mu1,mu3,Sigma1,Sigma2)</a>
<a class="sourceLine" id="cb70-11" title="11">  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</a>
<a class="sourceLine" id="cb70-12" title="12">  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb70-13" title="13">  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb70-14" title="14">  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.va</a>
<a class="sourceLine" id="cb70-15" title="15">}</a>
<a class="sourceLine" id="cb70-16" title="16"></a>
<a class="sourceLine" id="cb70-17" title="17">alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></a>
<a class="sourceLine" id="cb70-18" title="18">pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb70-19" title="19"><span class="kw">print</span>(pow)</a></code></pre></div>
<pre><code>## [1] 0.741 0.996 0.944</code></pre>
<p>在此条件下，energy优于Ball，优于NN</p>
</div>
<div id="unbalanced-samples" class="section level3">
<h3>6.Unbalanced samples</h3>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1">n1 &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb72-2" title="2">n2 &lt;-<span class="st"> </span><span class="dv">70</span></a>
<a class="sourceLine" id="cb72-3" title="3"></a>
<a class="sourceLine" id="cb72-4" title="4">mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb72-5" title="5">Sigma1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb72-6" title="6">Sigma2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>),<span class="dt">nrow=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb72-7" title="7"></a>
<a class="sourceLine" id="cb72-8" title="8"></a>
<a class="sourceLine" id="cb72-9" title="9"></a>
<a class="sourceLine" id="cb72-10" title="10">p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb72-11" title="11"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb72-12" title="12">  x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n1,mu1,Sigma1)</a>
<a class="sourceLine" id="cb72-13" title="13">  y &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n2,mu2,Sigma2)</a>
<a class="sourceLine" id="cb72-14" title="14">  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</a>
<a class="sourceLine" id="cb72-15" title="15">  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb72-16" title="16">  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb72-17" title="17">  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.va</a>
<a class="sourceLine" id="cb72-18" title="18">}</a>
<a class="sourceLine" id="cb72-19" title="19"></a>
<a class="sourceLine" id="cb72-20" title="20"></a>
<a class="sourceLine" id="cb72-21" title="21">alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></a>
<a class="sourceLine" id="cb72-22" title="22">pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb72-23" title="23"><span class="kw">print</span>(pow)</a></code></pre></div>
<pre><code>## [1] 0.222 0.223 0.727</code></pre>
<p>在此条件下Ball优于energy，约等于NN</p>
</div>
</div>
</div>
<div id="第八次作业" class="section level1">
<h1>第八次作业</h1>
<div id="q1" class="section level2">
<h2>Q1</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="kw">set.seed</span>(<span class="dv">233</span>)</a>
<a class="sourceLine" id="cb74-2" title="2"></a>
<a class="sourceLine" id="cb74-3" title="3">rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</a>
<a class="sourceLine" id="cb74-4" title="4">  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb74-5" title="5">  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb74-6" title="6">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb74-7" title="7">  k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb74-8" title="8">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb74-9" title="9">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb74-10" title="10">    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>])<span class="op">-</span><span class="kw">abs</span>(y)))</a>
<a class="sourceLine" id="cb74-11" title="11">      x[i] &lt;-<span class="st"> </span>y</a>
<a class="sourceLine" id="cb74-12" title="12">    <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb74-13" title="13">        x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb74-14" title="14">        k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb74-15" title="15">      }</a>
<a class="sourceLine" id="cb74-16" title="16">  }</a>
<a class="sourceLine" id="cb74-17" title="17">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb74-18" title="18">}</a>
<a class="sourceLine" id="cb74-19" title="19"></a>
<a class="sourceLine" id="cb74-20" title="20"></a>
<a class="sourceLine" id="cb74-21" title="21"></a>
<a class="sourceLine" id="cb74-22" title="22">N &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb74-23" title="23">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb74-24" title="24">x0 &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb74-25" title="25">rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, <span class="dt">N=</span>N)</a>
<a class="sourceLine" id="cb74-26" title="26">rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</a>
<a class="sourceLine" id="cb74-27" title="27">rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb74-28" title="28">rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</a>
<a class="sourceLine" id="cb74-29" title="29"></a>
<a class="sourceLine" id="cb74-30" title="30">result_table &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Sigma=</span>sigma,<span class="dt">reject_rate =</span> <span class="kw">c</span>(rw1<span class="op">$</span>k<span class="op">/</span>N, rw2<span class="op">$</span>k<span class="op">/</span>N, rw3<span class="op">$</span>k<span class="op">/</span>N, rw4<span class="op">$</span>k<span class="op">/</span>N))</a>
<a class="sourceLine" id="cb74-31" title="31"></a>
<a class="sourceLine" id="cb74-32" title="32"></a>
<a class="sourceLine" id="cb74-33" title="33"><span class="kw">print</span>(result_table)</a></code></pre></div>
<pre><code>##   Sigma reject_rate
## 1  0.05      0.0175
## 2  0.50      0.1635
## 3  2.00      0.4575
## 4 16.00      0.9080</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>N),rw1<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">xlab=</span><span class="st">&#39;sigma=0.05&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;X&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>N),rw2<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">xlab=</span><span class="st">&#39;sigma=0.5&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;X&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>N),rw3<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">xlab=</span><span class="st">&#39;sigma=2&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;X&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAXVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmZjpmZrZmtrZmtv+QOgCQkGaQ2/+2ZgC2Zma2tma225C2///bkDrb////tmb/25D//7b//9v///+Bl7vBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIu0lEQVR4nO3dCXfiNhQF4Ec6mTZ0SQptxwWi//8zx6skW8uVjewIfO/pSSHID+mLvExGeEQx0chXd6D0EAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBzAP6/JA2Lz9W6k55mQVUyVv34DI8eP7MAfr80CzVL/+v0JkSMwfodnwfHl52s5NlnkHyMFkDqD4G9VMoeAx6mJPiOkD1TtbxB49Aewfautx62Rhosms/ANMXz6DyhQgEsgrQcIhuErgO2jdQfSGErg93DlQLfUsqt1ug+grxPfr67oESyxEIlCMQKEcgUI5AoByBQDkCgXIEAuUIBMoRCJQjEChHIFCOQKAcgUA5AoFyBALlCATKEQiUm1YtD4xAIGUBpa+l2CzPCZSxswTKVeqxgPL1dqW/em6WTV3Cf/FMoLd+8Z21WtFbbsdAPU1wjaK36p6Arq8t0GSV63Rt5I6BOIMi6dYHfVPD4TpcbqdAqjU6nCKfRNg9UGK5zYAWFyYQKpW94axyBALlIkD3vOEISO6qRiBUKnvDWeViQHe8416B0jtLoHiHCAQ6RCDQIQiUPpo7gP6559Oos4Fk2vpuoLShzwS6/Tk8v77e9XHdhUCJlwEeIMAdrDkX6Fj/EbTJ+c57BsSBROUDEgwkzoO0t/E1/Pxofo1xfRXwYZXEcjOB4heSYsoCIDFAIyrPxJp/DLrI4Q/p59HyLAGyP6RtJtNoIoyBLBr9HdG11wLqJ9GdmQBNfvIGSKyBTIBGJURFgYZNE4FkUmPGiJrPxNcz6O77KaQAjQYtkgw0KAxAEgUS0zIH0O3YTJ/66503LckLJHOARFlKuYHWOov5gaTvfv+SAyS6rReoH3sCkMioilryyfUeaKXroGF8QSCJAEkQSHoR2QzITs4raQNkZoUGGqaDBSQaSCPMABIzwwxQzyz5gO6KD0j6/0ZAIlaXvUBipoUe6BjIbKqfKjU0FquGZVcc0PBj1pPdAhILSO8YHiAzE4yMBSQWkFhAul2JQBoqDmSN0gDJCMgwBIHsCWUmWOFAw4Dtn20ESHxA06ZKxPm+1osC9W9QFpB9DB76FwfSw5oO2BqkF8j7fefRFkDwNoEukKfDCUChpjOAnBdNt1YDwrcJtIHGx2C36+4YPUDTQSIgXzYDSrnJmxdIrQ4UzWZA4dsEWp1ZDGR9J2H0RQLNnUGe6520MSaNPp1oPPtWBEq/TaDpWX/a9vbbP8TUgavQM2svtb9uAZR8m0AMpEbHcDV+JQlF+f7nBZpssCZQarko0DAAD5D3WOVnMFdMSldQ9gtFA5nxdL0fjW8wywSkBiCVAKRKAxp++2D9QsIFUmMgD0YISM0BkgcAUhMgfeK1cGwgPcxUIL2RA2RKFQdkvjU8WwBkH2TMawDIXH8NXSoKyCZR2qZ/1QFSISDlAql0IDUBmv7GKnlEmTIBUhhIbQWkigeatEoAUhGgbvBKv0UPpHxAVp9KAVIYqG9mZtYUyBzBrAmgJkBKqfH7WIX02UF36SGB7Fmndxn/fmm96AApG0jtGEhhIPUIQCoGpOxWcSDzdb9A5vFoJNZGCMiubwH1zx8aaLSttWNFgJQB8lWOAqknBeofEsg/ZP29LECpvZndcG45fcRNf6d9As14pziQCgI5PZDR80KBnGfZgZJ78SBACRun7Y4YyF+WQKDsMwHhZgQCzYoESr89zoLiKhlodultgZJuj7OguHoSoLSbmywovmI2BfLfHidQbo9AnEGRpN8eZ0HxFTN0Y4vTfOD2OKJzT/G18/DXQWtnKyBroRkoVxpQ4HHyRokhEAiBQNKBCg6BQMo4ixUcAoF8GdDD5IuA5hVNbPclzRY2z1uUQHnaEajEZgub5y1KoDztCFRis4XN8xYlUJ52zwf0TCEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiCQ/EAXid2W2izC0u3iG8Ry/fVH7pJOsgNdmgVW4d5dv58m7cAGkdyO7UrJnCXd5Abq/uL+HLx197D6U7dDG4Rz6ddrZyzpSW6gbhVsFVxpXn2btEMbBHORt44mX0lfsgO18z20Srj+uf5WHy/erHZog1i6rbKWdJIbqNv1gweA27FZP3x+M+3ABvE3awzylnSyMVDf6OVHPqC8JZ1svYt1jV7fM+5iWUs62fog3TX6fspyRLWBMpV0svFpvut7PbAs5+QWKG9JJ1tfKLbdro+oWa7q+rNYzpJO8v9Ro4pf5p/rc/L7qB3YIJJ+F8tZ0gn/sApCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRQFFLxFrC/tP6scvtVTrhQFNCefH4eTqiTPGpdIHhYo6yqpSMoAur62K1i6Xewscvj7cLq+/nWs96Hmpf674u6AuVYBhVMEUDsbLvLeAp3rSXGRBqjdh+pnzTRpVklV9TdaSrP657yPGTSsNWyAul3n3AA1a5+7L++330/DXjXacP2jdBFA/YcuWqAO63Lo1mSaL+1HDyZAl/WP0WUAdafs7hhU+YEqkZf/JjNog/lTClCTeq8KzyD9xDoGVVv4FARU65hjUDUBatkuo12s8pzUVkgRQMPa3clZbDKDbkd7yrSH7w1SBFD7b3XUSPo66OXffr28fQw6nM7WVU8lo/P9aikDyEmmD1pkSHFA7ZwJ/qMC26c4oHZ32+b4m5TygAoLgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoH8BMH6xpc5oCALAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1"><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>N),rw4<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">xlab=</span><span class="st">&#39;sigma=16&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;X&#39;</span>)</a>
<a class="sourceLine" id="cb79-2" title="2"><span class="kw">mtext</span>(<span class="st">&quot;Random walk by different sigma&quot;</span>, <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">line =</span> <span class="dv">-3</span>, <span class="dt">outer =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li><p><span class="math inline">\(\sigma=0.05\)</span>时，拒绝率太低，几乎所有的点都被接受了，increment很小，链比较接近true random walk.</p></li>
<li><p><span class="math inline">\(\sigma=0.5\)</span>时，拒绝率0.18，2000次迭代也没趋于平稳.</p></li>
<li><p><span class="math inline">\(\sigma=2\)</span>时，拒绝率为0.5，大约在300次迭代后趋于平稳，表现很好.</p></li>
<li><p><span class="math inline">\(\sigma=16\)</span>时，拒绝率为0.89，绝大多数的点被拒绝了，虽然趋于平稳，但是效率非常低.</p></li>
</ul>
</div>
<div id="q2" class="section level2">
<h2>Q2</h2>
<p>For Exercise 9.4, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat R &lt; 1.2\)</span>.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1">Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</a>
<a class="sourceLine" id="cb80-2" title="2">  psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</a>
<a class="sourceLine" id="cb80-3" title="3">  n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</a>
<a class="sourceLine" id="cb80-4" title="4">  k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</a>
<a class="sourceLine" id="cb80-5" title="5">  psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi)</a>
<a class="sourceLine" id="cb80-6" title="6">  B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means)</a>
<a class="sourceLine" id="cb80-7" title="7">  psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)</a>
<a class="sourceLine" id="cb80-8" title="8">  W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w)</a>
<a class="sourceLine" id="cb80-9" title="9">  v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n)</a>
<a class="sourceLine" id="cb80-10" title="10">  r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W</a>
<a class="sourceLine" id="cb80-11" title="11">  <span class="kw">return</span>(r.hat)</a>
<a class="sourceLine" id="cb80-12" title="12">}</a>
<a class="sourceLine" id="cb80-13" title="13"></a>
<a class="sourceLine" id="cb80-14" title="14"></a>
<a class="sourceLine" id="cb80-15" title="15">rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</a>
<a class="sourceLine" id="cb80-16" title="16">  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb80-17" title="17">  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb80-18" title="18">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb80-19" title="19">  k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb80-20" title="20">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb80-21" title="21">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb80-22" title="22">    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>])<span class="op">-</span><span class="kw">abs</span>(y)))</a>
<a class="sourceLine" id="cb80-23" title="23">      x[i] &lt;-<span class="st"> </span>y</a>
<a class="sourceLine" id="cb80-24" title="24">    <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb80-25" title="25">      x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb80-26" title="26">      k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb80-27" title="27">    }</a>
<a class="sourceLine" id="cb80-28" title="28">  }</a>
<a class="sourceLine" id="cb80-29" title="29">  <span class="kw">return</span>(x)</a>
<a class="sourceLine" id="cb80-30" title="30">}</a>
<a class="sourceLine" id="cb80-31" title="31"></a>
<a class="sourceLine" id="cb80-32" title="32"></a>
<a class="sourceLine" id="cb80-33" title="33">sigma &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb80-34" title="34">k &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb80-35" title="35">n &lt;-<span class="st"> </span><span class="dv">15000</span></a>
<a class="sourceLine" id="cb80-36" title="36">b &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb80-37" title="37"></a>
<a class="sourceLine" id="cb80-38" title="38"><span class="co"># 初始值</span></a>
<a class="sourceLine" id="cb80-39" title="39">x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>, <span class="dv">-10</span>, <span class="dv">10</span>, <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb80-40" title="40"></a>
<a class="sourceLine" id="cb80-41" title="41"></a>
<a class="sourceLine" id="cb80-42" title="42">X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</a>
<a class="sourceLine" id="cb80-43" title="43"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</a>
<a class="sourceLine" id="cb80-44" title="44">  X[i, ] &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma,x0[i],n)</a>
<a class="sourceLine" id="cb80-45" title="45"></a>
<a class="sourceLine" id="cb80-46" title="46"><span class="co">#compute diagnostic statistics</span></a>
<a class="sourceLine" id="cb80-47" title="47">psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</a>
<a class="sourceLine" id="cb80-48" title="48"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</a>
<a class="sourceLine" id="cb80-49" title="49">  psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</a>
<a class="sourceLine" id="cb80-50" title="50"><span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi))</a></code></pre></div>
<pre><code>## [1] 1.041283</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="co">#plot psi for the four chains</span></a>
<a class="sourceLine" id="cb82-2" title="2"></a>
<a class="sourceLine" id="cb82-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</a>
<a class="sourceLine" id="cb82-4" title="4">  <span class="kw">plot</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb82-5" title="5">       <span class="dt">xlab=</span>i, <span class="dt">ylab=</span><span class="kw">bquote</span>(psi))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"><span class="co">#plot the sequence of R-hat statistics</span></a>
<a class="sourceLine" id="cb83-2" title="2">rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</a>
<a class="sourceLine" id="cb83-3" title="3"><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n)</a>
<a class="sourceLine" id="cb83-4" title="4">  rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</a>
<a class="sourceLine" id="cb83-5" title="5"><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</a>
<a class="sourceLine" id="cb83-6" title="6"><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="q3" class="section level2">
<h2>Q3</h2>
<p>Find the intersection points <span class="math inline">\(A(k) \quad in \quad (0,\sqrt{k})\)</span> of the curves <span class="math display">\[S_{k-1}(a) = P(t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}})\]</span> and <span class="math display">\[S_k(a)=P(t(k) &gt; \sqrt{\frac{a^2k}{k+1-a^2}})\]</span> for k =4:25,100,500,1000,where t(k) is a Student t random variable with k degrees of freedom. (These intersection points determine the critical values for a t-test for scale-mixture errors proposed by Sz´ekely [260].)</p>
<div id="answer-13" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="kw">options</span>(<span class="dt">digits=</span><span class="dv">22</span>)</a>
<a class="sourceLine" id="cb84-2" title="2"><span class="co"># 函数S_{k-1}</span></a>
<a class="sourceLine" id="cb84-3" title="3">s_k_minus_one =<span class="st"> </span><span class="cf">function</span>(a,k){</a>
<a class="sourceLine" id="cb84-4" title="4">  result =<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(k <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span>(k <span class="op">-</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span>)), <span class="dt">df =</span> k<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb84-5" title="5">  <span class="kw">return</span>(result)</a>
<a class="sourceLine" id="cb84-6" title="6">}</a>
<a class="sourceLine" id="cb84-7" title="7"></a>
<a class="sourceLine" id="cb84-8" title="8"><span class="co"># 函数S_k</span></a>
<a class="sourceLine" id="cb84-9" title="9">s_k =<span class="st"> </span><span class="cf">function</span>(a,k) {</a>
<a class="sourceLine" id="cb84-10" title="10"> result =<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>k <span class="op">/</span><span class="st"> </span>(k <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span>)), <span class="dt">df =</span> k)</a>
<a class="sourceLine" id="cb84-11" title="11"> <span class="kw">return</span>(result)</a>
<a class="sourceLine" id="cb84-12" title="12">}</a>
<a class="sourceLine" id="cb84-13" title="13"></a>
<a class="sourceLine" id="cb84-14" title="14"></a>
<a class="sourceLine" id="cb84-15" title="15">k_list =<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb84-16" title="16">root =<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(k_list))</a>
<a class="sourceLine" id="cb84-17" title="17"></a>
<a class="sourceLine" id="cb84-18" title="18"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k_list)) {</a>
<a class="sourceLine" id="cb84-19" title="19">  eps =<span class="st"> </span><span class="fl">1e-4</span></a>
<a class="sourceLine" id="cb84-20" title="20">  <span class="co">## 要求根的函数</span></a>
<a class="sourceLine" id="cb84-21" title="21">  k &lt;-<span class="st"> </span>k_list[i]</a>
<a class="sourceLine" id="cb84-22" title="22"></a>
<a class="sourceLine" id="cb84-23" title="23">  f =<span class="st"> </span><span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb84-24" title="24">    <span class="kw">return</span>(<span class="kw">s_k</span>(a,k)<span class="op">-</span><span class="kw">s_k_minus_one</span>(a,k))</a>
<a class="sourceLine" id="cb84-25" title="25">  }</a>
<a class="sourceLine" id="cb84-26" title="26">  root[i]=<span class="kw">uniroot</span>(f, <span class="dt">interval =</span> <span class="kw">c</span>(eps, <span class="dv">2</span>))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb84-27" title="27">}</a>
<a class="sourceLine" id="cb84-28" title="28"><span class="kw">print</span>(root)</a></code></pre></div>
<pre><code>##  [1] 1.4921028730130454 1.5335564496826020 1.5627440807820199 1.5844300913565614
##  [5] 1.6011847294381076 1.6145213599512538 1.6253901684290346 1.6344185757921050
##  [9] 1.6420377554803334 1.6485538736005154 1.6541903614855600 1.6591141071847100
## [13] 1.6634522838793799 1.6673035032832868 1.6707454090467158 1.6738399693730757
## [17] 1.6766372432863821 1.6791781106640935 1.6814962841160563 1.6836198138910450
## [21] 1.6855722288530610 1.6873734122398754 1.7206078300486389 1.7297554530071726
## [25] 1.7309074654943339</code></pre>
<p>当k分别取4:25,100,500,1000时，根分别如上</p>
</div>
</div>
</div>
<div id="第九次作业" class="section level1">
<h1>第九次作业</h1>
<div id="a_b_o-blood-type-problem" class="section level2">
<h2>A_B_O blood type problem</h2>
<ul>
<li><p>完整数据的似然函数<span class="math inline">\(L=(p^2)^{n_{AA}}(q^2)^{n_{BB}}(r^2)^{n_{OO}}(2pr)^{n_{AO}}(2qr)^{n_{BO}}(2pq)^{n_{AB}}\)</span></p></li>
<li><p>在已知观测数据下<span class="math inline">\(n_{AA}\sim B(n_A.,\frac{p^2}{p^2+2pr}),n_{BB}\sim B(n_B.,\frac{q^2}{q^2+2qr})\)</span></p></li>
<li><p>按照EM算法，计算出:<span class="math inline">\(p_{i+1}=\frac{X}{X+Y+Z},q_{i+1}=\frac{Y}{X+Y+Z}\)</span>,其中<span class="math inline">\(X=n_{A.}+n_{AB}+n_{A.}\frac{p_i^2}{p_i^2+2p_ir_i},Y=n_{B.}+n_{AB}+n_{B.}\frac{q_i^2}{q_i^2+2q_ir_i},Z=2n_{OO}+n_{A.}+n_{B.}-n_{B.}\frac{q_i^2}{q_i^2+2q_ir_i}-n_{A.}\frac{p_i^2}{p_i^2+2p_ir_i}\)</span></p></li>
<li><p>取初始值<span class="math inline">\(p_0 = q_0=0.1,r_0=0.8\)</span>,迭代停止的条件为参数更新步长(欧氏距离)小于阈值<span class="math inline">\(e=1e^{-8}\)</span></p></li>
</ul>
<p>以上具体推导略,代码如下：</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1">n&lt;-<span class="dv">15</span></a>
<a class="sourceLine" id="cb86-2" title="2"></a>
<a class="sourceLine" id="cb86-3" title="3"><span class="co">#记录每次迭代产生的三个参数</span></a>
<a class="sourceLine" id="cb86-4" title="4">re&lt;-<span class="kw">matrix</span>(<span class="kw">rep</span>(<span class="dv">0</span>,n<span class="op">*</span><span class="dv">3</span>),<span class="dt">nrow=</span>n)</a>
<a class="sourceLine" id="cb86-5" title="5">R&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb86-6" title="6"></a>
<a class="sourceLine" id="cb86-7" title="7"><span class="co"># 初始值和阈值</span></a>
<a class="sourceLine" id="cb86-8" title="8">re[<span class="dv">1</span>,<span class="dv">1</span>]&lt;-<span class="fl">0.1</span></a>
<a class="sourceLine" id="cb86-9" title="9">re[<span class="dv">1</span>,<span class="dv">2</span>]&lt;-<span class="fl">0.1</span></a>
<a class="sourceLine" id="cb86-10" title="10">re[<span class="dv">1</span>,<span class="dv">3</span>]&lt;-<span class="fl">0.8</span></a>
<a class="sourceLine" id="cb86-11" title="11">e&lt;-<span class="fl">1e-8</span></a>
<a class="sourceLine" id="cb86-12" title="12">k=<span class="dv">1</span></a>
<a class="sourceLine" id="cb86-13" title="13">step&lt;-<span class="kw">sqrt</span>((re[k,<span class="dv">1</span>])<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(re[k,<span class="dv">1</span>])<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(re[k,<span class="dv">1</span>])<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb86-14" title="14"></a>
<a class="sourceLine" id="cb86-15" title="15"><span class="co"># 观测值</span></a>
<a class="sourceLine" id="cb86-16" title="16">n_A =<span class="st"> </span><span class="dv">444</span></a>
<a class="sourceLine" id="cb86-17" title="17">n_B =<span class="st"> </span><span class="dv">132</span></a>
<a class="sourceLine" id="cb86-18" title="18">n_OO =<span class="st"> </span><span class="dv">361</span></a>
<a class="sourceLine" id="cb86-19" title="19">n_AB =<span class="st"> </span><span class="dv">63</span></a>
<a class="sourceLine" id="cb86-20" title="20"></a>
<a class="sourceLine" id="cb86-21" title="21"></a>
<a class="sourceLine" id="cb86-22" title="22"></a>
<a class="sourceLine" id="cb86-23" title="23"><span class="cf">while</span>(step<span class="op">&gt;</span>e){</a>
<a class="sourceLine" id="cb86-24" title="24">  p&lt;-re[k,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb86-25" title="25">  q&lt;-re[k,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb86-26" title="26">  r&lt;-re[k,<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb86-27" title="27"></a>
<a class="sourceLine" id="cb86-28" title="28">  R[k]&lt;-n_A<span class="op">*</span><span class="kw">log</span>(p<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r)<span class="op">+</span>n_B<span class="op">*</span><span class="kw">log</span>(q<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r)<span class="op">+</span><span class="dv">722</span><span class="op">*</span><span class="kw">log</span>(r)<span class="op">+</span>n_AB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q)</a>
<a class="sourceLine" id="cb86-29" title="29"></a>
<a class="sourceLine" id="cb86-30" title="30">  X&lt;-n_A<span class="op">+</span>n_AB<span class="op">+</span>n_A<span class="op">*</span>p<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(p<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r)</a>
<a class="sourceLine" id="cb86-31" title="31">  Y&lt;-n_B<span class="op">+</span>n_AB<span class="op">+</span>n_B<span class="op">*</span>q<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(q<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r)</a>
<a class="sourceLine" id="cb86-32" title="32">  Z&lt;-<span class="dv">2</span><span class="op">*</span>n_OO<span class="op">+</span>n_A<span class="op">+</span>n_B<span class="op">-</span>n_B<span class="op">*</span>q<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(q<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r)<span class="op">-</span>n_A<span class="op">*</span>p<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(p<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r)</a>
<a class="sourceLine" id="cb86-33" title="33"></a>
<a class="sourceLine" id="cb86-34" title="34">  <span class="co">## 更新参数</span></a>
<a class="sourceLine" id="cb86-35" title="35">  re[k<span class="op">+</span><span class="dv">1</span>,<span class="dv">1</span>]&lt;-X<span class="op">/</span>(X<span class="op">+</span>Y<span class="op">+</span>Z)</a>
<a class="sourceLine" id="cb86-36" title="36">  re[k<span class="op">+</span><span class="dv">1</span>,<span class="dv">2</span>]&lt;-Y<span class="op">/</span>(X<span class="op">+</span>Y<span class="op">+</span>Z)</a>
<a class="sourceLine" id="cb86-37" title="37">  re[k<span class="op">+</span><span class="dv">1</span>,<span class="dv">3</span>]&lt;-Z<span class="op">/</span>(X<span class="op">+</span>Y<span class="op">+</span>Z)</a>
<a class="sourceLine" id="cb86-38" title="38"></a>
<a class="sourceLine" id="cb86-39" title="39">  step&lt;-<span class="kw">sqrt</span>((re[k<span class="op">+</span><span class="dv">1</span>,<span class="dv">1</span>]<span class="op">-</span>re[k,<span class="dv">1</span>])<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(re[k<span class="op">+</span><span class="dv">1</span>,<span class="dv">2</span>]<span class="op">-</span>re[k,<span class="dv">2</span>])<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(re[k<span class="op">+</span><span class="dv">1</span>,<span class="dv">3</span>]<span class="op">-</span>re[k,<span class="dv">3</span>])<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb86-40" title="40"></a>
<a class="sourceLine" id="cb86-41" title="41">  k&lt;-k<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb86-42" title="42">}</a>
<a class="sourceLine" id="cb86-43" title="43"></a>
<a class="sourceLine" id="cb86-44" title="44"><span class="kw">print</span>(<span class="st">&quot;p,r,q is &quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;p,r,q is &quot;</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="kw">print</span>(re[<span class="dv">1</span><span class="op">:</span>(k<span class="dv">-1</span>),])</a></code></pre></div>
<pre><code>##                      [,1]                [,2]                [,3]
##  [1,] 0.10000000000000001 0.10000000000000001 0.80000000000000004
##  [2,] 0.26655882352941179 0.10138235294117647 0.63205882352941178
##  [3,] 0.29216006955786561 0.10240020893014842 0.60543972151198600
##  [4,] 0.29665224909186455 0.10264621069422152 0.60070154021391398
##  [5,] 0.29746152665436526 0.10269508729611707 0.59984338604951770
##  [6,] 0.29760816147755992 0.10270421542472305 0.59968762309771706
##  [7,] 0.29763476562891250 0.10270588675102621 0.59965934762006134
##  [8,] 0.29763959397993556 0.10270619089633579 0.59965421512372874
##  [9,] 0.29764047033974272 0.10270624614276858 0.59965328351748870
## [10,] 0.29764062940483477 0.10270625617260906 0.59965311442255620
## [11,] 0.29764065827635444 0.10270625799321728 0.59965308373042836</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&#39;Final para is &#39;</span>,<span class="st">&#39;p=&#39;</span>,re[k<span class="dv">-1</span>,<span class="dv">1</span>],<span class="st">&#39;  q=&#39;</span>,re[k<span class="dv">-1</span>,<span class="dv">2</span>],<span class="st">&#39;   r=&#39;</span>,re[k<span class="dv">-1</span>,<span class="dv">3</span>]))</a></code></pre></div>
<pre><code>## [1] &quot;Final para is p=0.297640658276354  q=0.102706257993217   r=0.599653083730428&quot;</code></pre>
<p>每次迭代，log极大似然的值如下:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="kw">print</span>(R)</a></code></pre></div>
<pre><code>##  [1] -1428.2142343435926 -1174.0920870211969 -1169.9514615420044
##  [4] -1169.8258098539354 -1169.8217280737322 -1169.8215939374516
##  [7] -1169.8215895203271 -1169.8215893748163 -1169.8215893700228
## [10] -1169.8215893698643 -1169.8215893698593     0.0000000000000
## [13]     0.0000000000000     0.0000000000000     0.0000000000000</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1"><span class="kw">plot</span>(R[<span class="dv">1</span><span class="op">:</span>(k<span class="dv">-1</span>)],<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>,<span class="dt">xlab=</span><span class="st">&quot;iter_time&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;loglikelyhood&quot;</span>,<span class="dt">type=</span><span class="st">&#39;b&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>由上图可以看出，log MLE是递增的。</p>
</div>
<div id="exercise-3page-204" class="section level2">
<h2>Exercise 3(Page 204)</h2>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:</p>
<p>formulas &lt;- list(</p>
<p>mpg ~ disp,</p>
<p>mpg ~ I(1 / disp),</p>
<p>mpg ~ disp + wt,</p>
<p>mpg ~ I(1 / disp) + wt</p>
<p>)</p>
</div>
<div id="answer-14" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="co"># formulas</span></a>
<a class="sourceLine" id="cb95-2" title="2">formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb95-3" title="3">mpg <span class="op">~</span><span class="st"> </span>disp,</a>
<a class="sourceLine" id="cb95-4" title="4">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb95-5" title="5">mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</a>
<a class="sourceLine" id="cb95-6" title="6">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</a>
<a class="sourceLine" id="cb95-7" title="7">)</a>
<a class="sourceLine" id="cb95-8" title="8"></a>
<a class="sourceLine" id="cb95-9" title="9"><span class="co">#使用lapply函数</span></a>
<a class="sourceLine" id="cb95-10" title="10">la &lt;-<span class="st"> </span><span class="kw">lapply</span>(formulas, lm, <span class="dt">data=</span>mtcars)</a>
<a class="sourceLine" id="cb95-11" title="11"></a>
<a class="sourceLine" id="cb95-12" title="12"><span class="co">#使用loop</span></a>
<a class="sourceLine" id="cb95-13" title="13">lp &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(formulas))</a>
<a class="sourceLine" id="cb95-14" title="14">len&lt;-<span class="kw">seq_along</span>(formulas)</a>
<a class="sourceLine" id="cb95-15" title="15"><span class="cf">for</span> (i <span class="cf">in</span> len){</a>
<a class="sourceLine" id="cb95-16" title="16">  lp[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(formulas[[i]], <span class="dt">data=</span>mtcars)</a>
<a class="sourceLine" id="cb95-17" title="17">}</a>
<a class="sourceLine" id="cb95-18" title="18"></a>
<a class="sourceLine" id="cb95-19" title="19"><span class="kw">print</span>(<span class="st">&quot;The results of lapply:&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;The results of lapply:&quot;</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"><span class="kw">print</span>(la)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
##           (Intercept)                   disp  
## 29.599854756163942682  -0.041215119962786144  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
##          (Intercept)             I(1/disp)  
##   10.752018027458552  1557.673934382552488  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
##           (Intercept)                   disp                     wt  
## 34.960554036237262210  -0.017724744272828108  -3.350825333348312007  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
##           (Intercept)              I(1/disp)                     wt  
##   19.0242062246238355  1142.5599748539309530    -1.7976490087983228</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="kw">print</span>(<span class="st">&quot;The results of loop:&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;The results of loop:&quot;</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1"><span class="kw">print</span>(lp)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
##           (Intercept)                   disp  
## 29.599854756163942682  -0.041215119962786144  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
##          (Intercept)             I(1/disp)  
##   10.752018027458552  1557.673934382552488  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
##           (Intercept)                   disp                     wt  
## 34.960554036237262210  -0.017724744272828108  -3.350825333348312007  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
##           (Intercept)              I(1/disp)                     wt  
##   19.0242062246238355  1142.5599748539309530    -1.7976490087983228</code></pre>
</div>
<div id="exercise-3page-213" class="section level2">
<h2>Exercise 3(Page 213)</h2>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</p>
<p>trials &lt;- replicate(</p>
<p>100,</p>
<p>t.test(rpois(10, 10), rpois(7, 10)),</p>
<p>simplify = FALSE</p>
<p>)</p>
<p>Extra challenge: get rid of the anonymous function by using [[ directly.</p>
<div id="answer-15" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1">trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</a>
<a class="sourceLine" id="cb103-2" title="2">  <span class="dv">100</span>,</a>
<a class="sourceLine" id="cb103-3" title="3">  <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</a>
<a class="sourceLine" id="cb103-4" title="4">  <span class="dt">simplify =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb103-5" title="5">)</a>
<a class="sourceLine" id="cb103-6" title="6"></a>
<a class="sourceLine" id="cb103-7" title="7"><span class="co"># sapply()和匿名函数:</span></a>
<a class="sourceLine" id="cb103-8" title="8"><span class="kw">sapply</span>(trials, <span class="cf">function</span>(x) x[[<span class="st">&quot;p.value&quot;</span>]])</a></code></pre></div>
<pre><code>##   [1] 0.9592734085355067997 0.8260650322461651207 0.8004869504042354533
##   [4] 0.5697898970822669051 0.3448195479786908546 0.8276821974039808572
##   [7] 0.3534668786274003383 0.0570752100870999118 0.1115442013550187739
##  [10] 0.2972457097890439659 0.1372495695591489095 0.5667647396476593880
##  [13] 0.2150059513517788012 0.4815324266832726741 0.2919154499507093936
##  [16] 0.5597220973701626523 0.1128648645453086824 0.0398080431736437187
##  [19] 0.4193261239771619575 0.3083045470715386482 0.5120950441170702971
##  [22] 0.0819538885776756876 0.4171617590599420167 0.2020483306291252779
##  [25] 0.2148108957317411138 0.6173059031269894081 0.0817370589864857833
##  [28] 0.9074458974669450395 0.3699573443934672801 0.5457167968218662457
##  [31] 0.5409755757858150105 0.3705479139701539637 0.3500666877092318829
##  [34] 0.8043819311682067763 0.2714425219226626607 0.3005553174672901950
##  [37] 0.7820193365302603450 0.1976909378590966382 0.6971502369586539682
##  [40] 0.3190400156862210901 0.0132204310854798310 0.0118019936424330896
##  [43] 0.5117932366294706270 0.5659358116576524989 0.5457808659161506037
##  [46] 0.4045222081875616826 0.2747765175057847453 0.0940446014799713320
##  [49] 0.3002462093797451104 0.5789286249373578608 0.0607025475990180668
##  [52] 0.2931128724230356308 0.5494834731841734543 0.6550737207439618626
##  [55] 0.0921736526026102343 0.4001601817581997844 0.0909428686274775383
##  [58] 0.0944025371122433482 0.6687870883509638986 0.9849617047975807171
##  [61] 0.1937847961025714050 0.9899123407086860560 0.3208945736306865193
##  [64] 0.0020528079443032647 0.8131788006598666962 0.7917612967912218691
##  [67] 0.7955745098131037363 0.3355222646309463652 0.3303160617083253925
##  [70] 0.0071097040684225806 0.3847430505057662931 0.9501715792827947205
##  [73] 0.1122869004478654203 0.2044320143739989104 0.7617500740091036615
##  [76] 0.2008538975274690719 0.5309948081286010035 0.5991589451781946796
##  [79] 0.4028796593511688728 0.5050063517529495005 0.9709491964759142668
##  [82] 0.3381657201957138925 0.7000738846409557681 0.3308044692219895833
##  [85] 0.3556088526238048164 0.8606602157185846425 0.3887432944403217405
##  [88] 0.4925464134479282663 0.4082862992231879318 0.7176683872816349563
##  [91] 0.1268592079174403475 0.3974541879186056503 0.3667351786436132688
##  [94] 0.6555582868436228283 0.3177655921798760441 0.7562153391364999644
##  [97] 0.7345509956322386902 0.4523364426591711673 0.1718637073623674183
## [100] 0.9659885514492080327</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1"><span class="co"># 不使用匿名函数:</span></a>
<a class="sourceLine" id="cb105-2" title="2"><span class="kw">sapply</span>(trials, <span class="st">&quot;[[&quot;</span>, <span class="st">&quot;p.value&quot;</span>)</a></code></pre></div>
<pre><code>##   [1] 0.9592734085355067997 0.8260650322461651207 0.8004869504042354533
##   [4] 0.5697898970822669051 0.3448195479786908546 0.8276821974039808572
##   [7] 0.3534668786274003383 0.0570752100870999118 0.1115442013550187739
##  [10] 0.2972457097890439659 0.1372495695591489095 0.5667647396476593880
##  [13] 0.2150059513517788012 0.4815324266832726741 0.2919154499507093936
##  [16] 0.5597220973701626523 0.1128648645453086824 0.0398080431736437187
##  [19] 0.4193261239771619575 0.3083045470715386482 0.5120950441170702971
##  [22] 0.0819538885776756876 0.4171617590599420167 0.2020483306291252779
##  [25] 0.2148108957317411138 0.6173059031269894081 0.0817370589864857833
##  [28] 0.9074458974669450395 0.3699573443934672801 0.5457167968218662457
##  [31] 0.5409755757858150105 0.3705479139701539637 0.3500666877092318829
##  [34] 0.8043819311682067763 0.2714425219226626607 0.3005553174672901950
##  [37] 0.7820193365302603450 0.1976909378590966382 0.6971502369586539682
##  [40] 0.3190400156862210901 0.0132204310854798310 0.0118019936424330896
##  [43] 0.5117932366294706270 0.5659358116576524989 0.5457808659161506037
##  [46] 0.4045222081875616826 0.2747765175057847453 0.0940446014799713320
##  [49] 0.3002462093797451104 0.5789286249373578608 0.0607025475990180668
##  [52] 0.2931128724230356308 0.5494834731841734543 0.6550737207439618626
##  [55] 0.0921736526026102343 0.4001601817581997844 0.0909428686274775383
##  [58] 0.0944025371122433482 0.6687870883509638986 0.9849617047975807171
##  [61] 0.1937847961025714050 0.9899123407086860560 0.3208945736306865193
##  [64] 0.0020528079443032647 0.8131788006598666962 0.7917612967912218691
##  [67] 0.7955745098131037363 0.3355222646309463652 0.3303160617083253925
##  [70] 0.0071097040684225806 0.3847430505057662931 0.9501715792827947205
##  [73] 0.1122869004478654203 0.2044320143739989104 0.7617500740091036615
##  [76] 0.2008538975274690719 0.5309948081286010035 0.5991589451781946796
##  [79] 0.4028796593511688728 0.5050063517529495005 0.9709491964759142668
##  [82] 0.3381657201957138925 0.7000738846409557681 0.3308044692219895833
##  [85] 0.3556088526238048164 0.8606602157185846425 0.3887432944403217405
##  [88] 0.4925464134479282663 0.4082862992231879318 0.7176683872816349563
##  [91] 0.1268592079174403475 0.3974541879186056503 0.3667351786436132688
##  [94] 0.6555582868436228283 0.3177655921798760441 0.7562153391364999644
##  [97] 0.7345509956322386902 0.4523364426591711673 0.1718637073623674183
## [100] 0.9659885514492080327</code></pre>
</div>
</div>
<div id="exercise-6page-216" class="section level2">
<h2>Exercise 6(Page 216)</h2>
<p>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
<div id="answer-16" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1">tryList &lt;-<span class="st"> </span><span class="kw">list</span>(iris, mtcars, cars)</a>
<a class="sourceLine" id="cb107-2" title="2"></a>
<a class="sourceLine" id="cb107-3" title="3"><span class="co"># lapply</span></a>
<a class="sourceLine" id="cb107-4" title="4"><span class="kw">lapply</span>(tryList, <span class="cf">function</span>(x) <span class="kw">vapply</span>(x, mean, <span class="kw">numeric</span>(<span class="dv">1</span>)))</a></code></pre></div>
<pre><code>## [[1]]
##       Sepal.Length        Sepal.Width       Petal.Length        Petal.Width 
## 5.8433333333333337 3.0573333333333332 3.7580000000000000 1.1993333333333334 
##            Species 
##                 NA 
## 
## [[2]]
##                  mpg                  cyl                 disp 
##  20.0906249999999993   6.1875000000000000 230.7218750000000114 
##                   hp                 drat                   wt 
## 146.6875000000000000   3.5965625000000001   3.2172499999999999 
##                 qsec                   vs                   am 
##  17.8487499999999990   0.4375000000000000   0.4062500000000000 
##                 gear                 carb 
##   3.6875000000000000   2.8125000000000000 
## 
## [[3]]
##              speed               dist 
## 15.400000000000000 42.979999999999997</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1">lmapply &lt;-<span class="st"> </span><span class="cf">function</span>(X, FUN, FUN.VALUE, <span class="dt">simplify =</span> <span class="ot">FALSE</span>){</a>
<a class="sourceLine" id="cb109-2" title="2">  out &lt;-<span class="st"> </span><span class="kw">Map</span>(<span class="cf">function</span>(x) <span class="kw">vapply</span>(x, FUN, FUN.VALUE), X)</a>
<a class="sourceLine" id="cb109-3" title="3">  <span class="cf">if</span>(simplify <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>){<span class="kw">return</span>(<span class="kw">simplify2array</span>(out))}</a>
<a class="sourceLine" id="cb109-4" title="4">  out</a>
<a class="sourceLine" id="cb109-5" title="5">}</a>
<a class="sourceLine" id="cb109-6" title="6"></a>
<a class="sourceLine" id="cb109-7" title="7"><span class="kw">lmapply</span>(tryList, mean, <span class="kw">numeric</span>(<span class="dv">1</span>))</a></code></pre></div>
<pre><code>## [[1]]
##       Sepal.Length        Sepal.Width       Petal.Length        Petal.Width 
## 5.8433333333333337 3.0573333333333332 3.7580000000000000 1.1993333333333334 
##            Species 
##                 NA 
## 
## [[2]]
##                  mpg                  cyl                 disp 
##  20.0906249999999993   6.1875000000000000 230.7218750000000114 
##                   hp                 drat                   wt 
## 146.6875000000000000   3.5965625000000001   3.2172499999999999 
##                 qsec                   vs                   am 
##  17.8487499999999990   0.4375000000000000   0.4062500000000000 
##                 gear                 carb 
##   3.6875000000000000   2.8125000000000000 
## 
## [[3]]
##              speed               dist 
## 15.400000000000000 42.979999999999997</code></pre>
</div>
</div>
</div>
<div id="第十次作业" class="section level1">
<h1>第十次作业</h1>
<div id="第一题" class="section level2">
<h2>第一题</h2>
<ul>
<li><p>Write an Rcpp function for Exercise 9.4 (page 277, Statistical Computing with R).</p></li>
<li><p>Compare the corresponding generated random numbers with those by the R function you wrote before using the function “qqplot”.</p></li>
<li><p>Campare the computation time of the two functions with the function “microbenchmark”.</p></li>
<li><p>Comments your results</p></li>
</ul>
<div id="r函数如下" class="section level3">
<h3>R函数如下</h3>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1"><span class="kw">set.seed</span>(<span class="dv">233</span>)</a>
<a class="sourceLine" id="cb111-2" title="2">rw_R &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</a>
<a class="sourceLine" id="cb111-3" title="3">  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb111-4" title="4">  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb111-5" title="5">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb111-6" title="6">  k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb111-7" title="7">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb111-8" title="8">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb111-9" title="9">    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>])<span class="op">-</span><span class="kw">abs</span>(y)))</a>
<a class="sourceLine" id="cb111-10" title="10">      x[i] &lt;-<span class="st"> </span>y </a>
<a class="sourceLine" id="cb111-11" title="11">    <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb111-12" title="12">      x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb111-13" title="13">      k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb111-14" title="14">    }</a>
<a class="sourceLine" id="cb111-15" title="15">  }</a>
<a class="sourceLine" id="cb111-16" title="16">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb111-17" title="17">}</a></code></pre></div>
</div>
<div id="rcpp写的函数如下" class="section level3">
<h3>RCpp写的函数如下</h3>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1"><span class="kw">library</span>(inline)</a>
<a class="sourceLine" id="cb112-2" title="2"></a>
<a class="sourceLine" id="cb112-3" title="3">rw_C_code &lt;-<span class="st"> &#39;</span></a>
<a class="sourceLine" id="cb112-4" title="4"><span class="st">  </span></a>
<a class="sourceLine" id="cb112-5" title="5"><span class="st">  using namespace Rcpp;</span></a>
<a class="sourceLine" id="cb112-6" title="6"><span class="st">  #include &lt;math.h&gt;;</span></a>
<a class="sourceLine" id="cb112-7" title="7"></a>
<a class="sourceLine" id="cb112-8" title="8"><span class="st">  // n and thin are SEXPs which the Rcpp::as function maps to C++ vars</span></a>
<a class="sourceLine" id="cb112-9" title="9"><span class="st">  int N   = as&lt;int&gt;(n);</span></a>
<a class="sourceLine" id="cb112-10" title="10"><span class="st">  double x = as&lt;double&gt;(thin);</span></a>
<a class="sourceLine" id="cb112-11" title="11"><span class="st">  double sigma = as&lt;double&gt;(s);</span></a>
<a class="sourceLine" id="cb112-12" title="12"><span class="st">  </span></a>
<a class="sourceLine" id="cb112-13" title="13"><span class="st">  NumericMatrix mat(N, 2);</span></a>
<a class="sourceLine" id="cb112-14" title="14"><span class="st">  </span></a>
<a class="sourceLine" id="cb112-15" title="15"><span class="st">  RNGScope scope;         // Initialize Random number generator</span></a>
<a class="sourceLine" id="cb112-16" title="16"></a>
<a class="sourceLine" id="cb112-17" title="17"></a>
<a class="sourceLine" id="cb112-18" title="18"><span class="st">  mat(0,0) = x;</span></a>
<a class="sourceLine" id="cb112-19" title="19"><span class="st">  double k =0;</span></a>
<a class="sourceLine" id="cb112-20" title="20"><span class="st">  for (int i=1;i&lt;=N;i++){</span></a>
<a class="sourceLine" id="cb112-21" title="21"><span class="st">      double u = ::Rf_runif(0,1);</span></a>
<a class="sourceLine" id="cb112-22" title="22"><span class="st">      double y = ::Rf_rnorm(mat(i-1,0),sigma);</span></a>
<a class="sourceLine" id="cb112-23" title="23"><span class="st">      if (u &lt;= exp(abs(mat(i-1,0))-abs(y))){</span></a>
<a class="sourceLine" id="cb112-24" title="24"><span class="st">        mat(i,0) = y;</span></a>
<a class="sourceLine" id="cb112-25" title="25"><span class="st">      }</span></a>
<a class="sourceLine" id="cb112-26" title="26"><span class="st">      else {</span></a>
<a class="sourceLine" id="cb112-27" title="27"><span class="st">        mat(i,0) = mat(i-1,0);</span></a>
<a class="sourceLine" id="cb112-28" title="28"><span class="st">        k = k+1;</span></a>
<a class="sourceLine" id="cb112-29" title="29"><span class="st">      }</span></a>
<a class="sourceLine" id="cb112-30" title="30"><span class="st">  }</span></a>
<a class="sourceLine" id="cb112-31" title="31"><span class="st">  mat(0,1) = k;</span></a>
<a class="sourceLine" id="cb112-32" title="32"><span class="st">  </span></a>
<a class="sourceLine" id="cb112-33" title="33"><span class="st">  return mat;</span></a>
<a class="sourceLine" id="cb112-34" title="34"><span class="st">&#39;</span></a>
<a class="sourceLine" id="cb112-35" title="35"><span class="co"># Compile and Load</span></a>
<a class="sourceLine" id="cb112-36" title="36">rw_C &lt;-<span class="st"> </span><span class="kw">cxxfunction</span>(<span class="kw">signature</span>(<span class="dt">n=</span><span class="st">&quot;int&quot;</span>, <span class="dt">thin =</span> <span class="st">&quot;double&quot;</span>, <span class="dt">s =</span> <span class="st">&quot;double&quot;</span>),</a>
<a class="sourceLine" id="cb112-37" title="37">                         rw_C_code, <span class="dt">plugin=</span><span class="st">&quot;Rcpp&quot;</span>)</a></code></pre></div>
</div>
<div id="两种方法生成的链对比取n2000sigma2x010" class="section level3">
<h3>两种方法生成的链对比(取N=2000,sigma=2,x0=10)</h3>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1">result_R &lt;-<span class="st"> </span><span class="kw">rw_R</span>(<span class="dt">sigma=</span><span class="fl">0.5</span>,<span class="dt">x0=</span><span class="dv">10</span>,<span class="dt">N=</span><span class="dv">2000</span>)<span class="op">$</span>x</a>
<a class="sourceLine" id="cb113-2" title="2">result_C &lt;-<span class="st"> </span><span class="kw">rw_C</span>(<span class="dt">n=</span><span class="dv">2000</span>,<span class="dt">thin=</span><span class="dv">10</span>,<span class="dt">s=</span><span class="fl">0.5</span>)[,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb113-3" title="3"></a>
<a class="sourceLine" id="cb113-4" title="4"><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>),result_R,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">col=</span><span class="st">&#39;black&#39;</span>,<span class="dt">xlab=</span><span class="st">&#39;sigma=0.5&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;X&#39;</span>,<span class="dt">lty=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb113-5" title="5"><span class="kw">lines</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>),result_C,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>,<span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb113-6" title="6"><span class="kw">legend</span>(<span class="dv">1500</span>, <span class="dv">9</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;R&quot;</span>,<span class="st">&quot;C++&quot;</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;red&quot;</span>), <span class="dt">lty=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">cex=</span><span class="fl">0.8</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="拒绝率对比" class="section level3">
<h3>拒绝率对比：</h3>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1">N &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb114-2" title="2">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb114-3" title="3">x0 &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb114-4" title="4">rw_R1 &lt;-<span class="st"> </span><span class="kw">rw_R</span>(sigma[<span class="dv">1</span>], x0, N)</a>
<a class="sourceLine" id="cb114-5" title="5">rw_R2 &lt;-<span class="st"> </span><span class="kw">rw_R</span>(sigma[<span class="dv">2</span>], x0, N)</a>
<a class="sourceLine" id="cb114-6" title="6">rw_R3 &lt;-<span class="st"> </span><span class="kw">rw_R</span>(sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb114-7" title="7">rw_R4 &lt;-<span class="st"> </span><span class="kw">rw_R</span>(sigma[<span class="dv">4</span>], x0, N)</a>
<a class="sourceLine" id="cb114-8" title="8"></a>
<a class="sourceLine" id="cb114-9" title="9">rw_C1 &lt;-<span class="st"> </span><span class="kw">rw_C</span>(N,x0,sigma[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb114-10" title="10">rw_C2 &lt;-<span class="st"> </span><span class="kw">rw_C</span>(N,x0,sigma[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb114-11" title="11">rw_C3 &lt;-<span class="st"> </span><span class="kw">rw_C</span>(N,x0,sigma[<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb114-12" title="12">rw_C4 &lt;-<span class="st"> </span><span class="kw">rw_C</span>(N,x0,sigma[<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb114-13" title="13"></a>
<a class="sourceLine" id="cb114-14" title="14">result_table &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Sigma=</span>sigma,<span class="dt">reject_rate_R =</span> <span class="kw">c</span>(rw_R1<span class="op">$</span>k<span class="op">/</span>N, rw_R2<span class="op">$</span>k<span class="op">/</span>N, rw_R3<span class="op">$</span>k<span class="op">/</span>N, rw_R4<span class="op">$</span>k<span class="op">/</span>N),<span class="dt">reject_rate_C =</span> <span class="kw">c</span>(rw_C1[<span class="dv">1</span>,<span class="dv">2</span>]<span class="op">/</span>N,rw_C2[<span class="dv">1</span>,<span class="dv">2</span>]<span class="op">/</span>N,rw_C3[<span class="dv">1</span>,<span class="dv">2</span>]<span class="op">/</span>N,rw_C4[<span class="dv">1</span>,<span class="dv">2</span>]<span class="op">/</span>N))</a>
<a class="sourceLine" id="cb114-15" title="15"><span class="kw">print</span>(result_table)</a></code></pre></div>
<pre><code>##                   Sigma        reject_rate_R        reject_rate_C
## 1  0.050000000000000003 0.021000000000000001 0.020500000000000001
## 2  0.500000000000000000 0.172999999999999987 0.164500000000000007
## 3  2.000000000000000000 0.474999999999999978 0.456500000000000017
## 4 16.000000000000000000 0.903000000000000025 0.889499999999999957</code></pre>
</div>
<div id="性能对比" class="section level3">
<h3>性能对比:</h3>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" title="1"><span class="kw">library</span>(microbenchmark)</a>
<a class="sourceLine" id="cb116-2" title="2">ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">rw.R=</span><span class="kw">rw_R</span>(<span class="dv">2</span>,<span class="dv">10</span>,<span class="dv">2000</span>),</a>
<a class="sourceLine" id="cb116-3" title="3">               <span class="dt">rw.C=</span><span class="kw">rw_C</span>(<span class="dv">2000</span>,<span class="dv">10</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb116-4" title="4"><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</a></code></pre></div>
<pre><code>##   expr                  lq               median                   uq
## 1 rw.R 9905.00000000000000 12169.20000000000073 13488.79999999999927
## 2 rw.C  453.60000000000002   572.79999999999995   593.95000000000005</code></pre>
</div>
<div id="总结" class="section level3">
<h3>总结</h3>
<ul>
<li><p>从结果上来看,RCpp和R得到的马尔可夫链以及模拟出的拒绝率很相似。</p></li>
<li><p>从速度上看,由microbenchmark比较的结果,RCpp所用时间大概为R的<span class="math inline">\(\frac{1}{20}\)</span></p></li>
</ul>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
